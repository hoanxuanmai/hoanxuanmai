- [C√¢u H·ªèi Ph·ªèng V·∫•n MySQL](#c√¢u-h·ªèi-ph·ªèng-v·∫•n-mysql)
  - [1. MySQL l√† g√¨?](#1-mysql-l√†-g√¨)
  - [2. C√°c lo·∫°i JOIN trong MySQL?](#2-c√°c-lo·∫°i-join-trong-mysql)
    - [1. INNER JOIN](#1-inner-join)
    - [2. LEFT JOIN (LEFT OUTER JOIN)](#2-left-join-left-outer-join)
    - [3. RIGHT JOIN (RIGHT OUTER JOIN)](#3-right-join-right-outer-join)
    - [4. FULL JOIN (FULL OUTER JOIN) *(MySQL kh√¥ng h·ªó tr·ª£ tr·ª±c ti·∫øp)*](#4-full-join-full-outer-join-mysql-kh√¥ng-h·ªó-tr·ª£-tr·ª±c-ti·∫øp)
    - [5. CROSS JOIN](#5-cross-join)
    - [6. SELF JOIN](#6-self-join)
  - [3. C√°ch ph√≤ng ch·ªëng SQL Injection trong MySQL?](#3-c√°ch-ph√≤ng-ch·ªëng-sql-injection-trong-mysql)
  - [4. Ch·ª©c nƒÉng c·ªßa INDEX trong MySQL?](#4-ch·ª©c-nƒÉng-c·ªßa-index-trong-mysql)
    - [Ph√¢n lo·∫°i INDEX trong MySQL:](#ph√¢n-lo·∫°i-index-trong-mysql)
    - [So s√°nh c√°c lo·∫°i INDEX:](#so-s√°nh-c√°c-lo·∫°i-index)
    - [Khi n√†o n√™n s·ª≠ d·ª•ng INDEX?](#khi-n√†o-n√™n-s·ª≠-d·ª•ng-index)
    - [Khi n√†o KH√îNG n√™n s·ª≠ d·ª•ng INDEX?](#khi-n√†o-kh√¥ng-n√™n-s·ª≠-d·ª•ng-index)
  - [5. S·ª± kh√°c nhau gi·ªØa MyISAM v√† InnoDB?](#5-s·ª±-kh√°c-nhau-gi·ªØa-myisam-v√†-innodb)
  - [6. C√°c lo·∫°i r√†ng bu·ªôc (Constraints) trong MySQL?](#6-c√°c-lo·∫°i-r√†ng-bu·ªôc-constraints-trong-mysql)
  - [7. ACID trong MySQL l√† g√¨?](#7-acid-trong-mysql-l√†-g√¨)
- [**T·ªëi ∆∞u h√≥a**](#t·ªëi-∆∞u-h√≥a)
  - [**1. T·ªëi ∆∞u h√≥a thi·∫øt k·∫ø database (Database Schema Optimization)**](#1-t·ªëi-∆∞u-h√≥a-thi·∫øt-k·∫ø-database-database-schema-optimization)
    - [**1.1. Ch·ªçn ki·ªÉu d·ªØ li·ªáu ph√π h·ª£p**](#11-ch·ªçn-ki·ªÉu-d·ªØ-li·ªáu-ph√π-h·ª£p)
      - [**üõ†Ô∏è Nguy√™n t·∫Øc ch·ªçn ki·ªÉu d·ªØ li·ªáu:**](#Ô∏è-nguy√™n-t·∫Øc-ch·ªçn-ki·ªÉu-d·ªØ-li·ªáu)
        - [**‚ùå V√≠ d·ª• k√©m t·ªëi ∆∞u:**](#-v√≠-d·ª•-k√©m-t·ªëi-∆∞u)
        - [**‚úÖ T·ªëi ∆∞u h∆°n:**](#-t·ªëi-∆∞u-h∆°n)
    - [**1.2. B√¨nh th∆∞·ªùng h√≥a (Normalization) vs. Phi chu·∫©n h√≥a (Denormalization)**](#12-b√¨nh-th∆∞·ªùng-h√≥a-normalization-vs-phi-chu·∫©n-h√≥a-denormalization)
  - [**2. T·ªëi ∆∞u h√≥a ch·ªâ m·ª•c (Index Optimization)**](#2-t·ªëi-∆∞u-h√≥a-ch·ªâ-m·ª•c-index-optimization)
    - [**2.1. Khi n√†o n√™n s·ª≠ d·ª•ng ch·ªâ m·ª•c?**](#21-khi-n√†o-n√™n-s·ª≠-d·ª•ng-ch·ªâ-m·ª•c)
    - [**2.2. C√°c lo·∫°i ch·ªâ m·ª•c**](#22-c√°c-lo·∫°i-ch·ªâ-m·ª•c)
        - [**‚úÖ V√≠ d·ª• t·∫°o ch·ªâ m·ª•c:**](#-v√≠-d·ª•-t·∫°o-ch·ªâ-m·ª•c)
        - [**üìä Ki·ªÉm tra MySQL c√≥ d√πng ch·ªâ m·ª•c kh√¥ng?**](#-ki·ªÉm-tra-mysql-c√≥-d√πng-ch·ªâ-m·ª•c-kh√¥ng)
  - [**3. T·ªëi ∆∞u h√≥a truy v·∫•n (Query Optimization)**](#3-t·ªëi-∆∞u-h√≥a-truy-v·∫•n-query-optimization)
        - [**‚ùå Truy v·∫•n k√©m t·ªëi ∆∞u:**](#-truy-v·∫•n-k√©m-t·ªëi-∆∞u)
        - [**‚úÖ Truy v·∫•n t·ªëi ∆∞u h∆°n:**](#-truy-v·∫•n-t·ªëi-∆∞u-h∆°n)
  - [**4. C·∫•u h√¨nh MySQL ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t**](#4-c·∫•u-h√¨nh-mysql-ƒë·ªÉ-t·ªëi-∆∞u-hi·ªáu-su·∫•t)
    - [**4.1. TƒÉng b·ªô nh·ªõ (`innodb_buffer_pool_size`)**](#41-tƒÉng-b·ªô-nh·ªõ-innodb_buffer_pool_size)
    - [**4.2. Gi·ªõi h·∫°n k·∫øt n·ªëi ƒë·ªÉ tr√°nh qu√° t·∫£i (`max_connections`)**](#42-gi·ªõi-h·∫°n-k·∫øt-n·ªëi-ƒë·ªÉ-tr√°nh-qu√°-t·∫£i-max_connections)
    - [**4.3. B·∫≠t b·ªô nh·ªõ cache (`query_cache_size`)** (ch·ªâ v·ªõi MySQL 5.7 tr·ªü xu·ªëng)](#43-b·∫≠t-b·ªô-nh·ªõ-cache-query_cache_size-ch·ªâ-v·ªõi-mysql-57-tr·ªü-xu·ªëng)
  - [**5. D√πng Cache ƒë·ªÉ gi·∫£m t·∫£i MySQL**](#5-d√πng-cache-ƒë·ªÉ-gi·∫£m-t·∫£i-mysql)
    - [**5.1. S·ª≠ d·ª•ng Redis ƒë·ªÉ cache k·∫øt qu·∫£ truy v·∫•n**](#51-s·ª≠-d·ª•ng-redis-ƒë·ªÉ-cache-k·∫øt-qu·∫£-truy-v·∫•n)
  - [**T√≥m t·∫Øt**](#t√≥m-t·∫Øt)
      - [**Ph√¢n bi·ªát Index, FULLTEXT Index v√† Partitioning trong MySQL**](#ph√¢n-bi·ªát-index-fulltext-index-v√†-partitioning-trong-mysql)
    - [**1. INDEX (B-Tree Index) ‚Äì Ch·ªâ m·ª•c th√¥ng th∆∞·ªùng**](#1-index-b-tree-index--ch·ªâ-m·ª•c-th√¥ng-th∆∞·ªùng)
      - [**1.1. M·ª•c ƒë√≠ch**](#11-m·ª•c-ƒë√≠ch)
      - [**1.2. ƒê·∫∑c ƒëi·ªÉm**](#12-ƒë·∫∑c-ƒëi·ªÉm)
      - [**1.3. V√≠ d·ª•**](#13-v√≠-d·ª•)
        - [**‚úÖ T·∫°o INDEX th√¥ng th∆∞·ªùng**](#-t·∫°o-index-th√¥ng-th∆∞·ªùng)
        - [**üìä Ki·ªÉm tra MySQL c√≥ s·ª≠ d·ª•ng INDEX kh√¥ng?**](#-ki·ªÉm-tra-mysql-c√≥-s·ª≠-d·ª•ng-index-kh√¥ng)
    - [**2. FULLTEXT INDEX ‚Äì Ch·ªâ m·ª•c to√†n vƒÉn**](#2-fulltext-index--ch·ªâ-m·ª•c-to√†n-vƒÉn)
      - [**2.1. M·ª•c ƒë√≠ch**](#21-m·ª•c-ƒë√≠ch)
      - [**2.2. ƒê·∫∑c ƒëi·ªÉm**](#22-ƒë·∫∑c-ƒëi·ªÉm)
      - [**2.3. V√≠ d·ª•**](#23-v√≠-d·ª•)
        - [**‚úÖ T·∫°o FULLTEXT INDEX**](#-t·∫°o-fulltext-index)
        - [**‚úÖ T√¨m ki·∫øm to√†n vƒÉn**](#-t√¨m-ki·∫øm-to√†n-vƒÉn)
        - [**‚úÖ T√¨m ki·∫øm Boolean (AND, OR, NOT)**](#-t√¨m-ki·∫øm-boolean-and-or-not)
    - [**3. PARTITIONING ‚Äì Chia nh·ªè b·∫£ng ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t**](#3-partitioning--chia-nh·ªè-b·∫£ng-ƒë·ªÉ-t·ªëi-∆∞u-hi·ªáu-su·∫•t)
      - [**3.1. M·ª•c ƒë√≠ch**](#31-m·ª•c-ƒë√≠ch)
      - [**3.2. ƒê·∫∑c ƒëi·ªÉm**](#32-ƒë·∫∑c-ƒëi·ªÉm)
      - [**3.3. C√°c lo·∫°i Partitioning**](#33-c√°c-lo·∫°i-partitioning)
      - [**3.4. V√≠ d·ª•**](#34-v√≠-d·ª•)
        - [**‚úÖ Partition theo nƒÉm (`RANGE`)**](#-partition-theo-nƒÉm-range)
        - [**‚úÖ Partition theo khu v·ª±c (`LIST`)**](#-partition-theo-khu-v·ª±c-list)
  - [**üîç T·ªïng k·∫øt: N√™n d√πng lo·∫°i n√†o?**](#-t·ªïng-k·∫øt-n√™n-d√πng-lo·∫°i-n√†o)
  - [**T·ªëi ∆∞u h√≥a Transaction trong MySQL**](#t·ªëi-∆∞u-h√≥a-transaction-trong-mysql)
    - [**1. Nguy√™n t·∫Øc c∆° b·∫£n c·ªßa Transaction trong MySQL**](#1-nguy√™n-t·∫Øc-c∆°-b·∫£n-c·ªßa-transaction-trong-mysql)
      - [**1.1. ACID ‚Äì 4 t√≠nh ch·∫•t quan tr·ªçng c·ªßa transaction**](#11-acid--4-t√≠nh-ch·∫•t-quan-tr·ªçng-c·ªßa-transaction)
      - [**1.2. C√°c c√¢u l·ªánh transaction c∆° b·∫£n**](#12-c√°c-c√¢u-l·ªánh-transaction-c∆°-b·∫£n)
    - [**2. C√°c v·∫•n ƒë·ªÅ hi·ªáu su·∫•t khi s·ª≠ d·ª•ng Transaction**](#2-c√°c-v·∫•n-ƒë·ªÅ-hi·ªáu-su·∫•t-khi-s·ª≠-d·ª•ng-transaction)
    - [**2.1. Hi·ªán t∆∞·ª£ng Lock (Kh√≥a d·ªØ li·ªáu)**](#21-hi·ªán-t∆∞·ª£ng-lock-kh√≥a-d·ªØ-li·ªáu)
      - [**üîπ MySQL c√≥ hai lo·∫°i lock ch√≠nh:**](#-mysql-c√≥-hai-lo·∫°i-lock-ch√≠nh)
    - [**2.2. Hi·ªán t∆∞·ª£ng Deadlock (Giao d·ªãch b·ªã k·∫πt nhau)**](#22-hi·ªán-t∆∞·ª£ng-deadlock-giao-d·ªãch-b·ªã-k·∫πt-nhau)
      - [**üîπ V√≠ d·ª• deadlock:**](#-v√≠-d·ª•-deadlock)
      - [**üîπ C√°ch tr√°nh Deadlock**](#-c√°ch-tr√°nh-deadlock)
    - [**3. K·ªπ thu·∫≠t t·ªëi ∆∞u Transaction trong MySQL**](#3-k·ªπ-thu·∫≠t-t·ªëi-∆∞u-transaction-trong-mysql)
      - [**3.1. Gi·∫£m th·ªùi gian gi·ªØ lock**](#31-gi·∫£m-th·ªùi-gian-gi·ªØ-lock)
      - [**3.2. S·ª≠ d·ª•ng Batch Processing thay v√¨ Transaction d√†i**](#32-s·ª≠-d·ª•ng-batch-processing-thay-v√¨-transaction-d√†i)
      - [**3.3. Ch·ªâ d√πng Transaction khi th·ª±c s·ª± c·∫ßn**](#33-ch·ªâ-d√πng-transaction-khi-th·ª±c-s·ª±-c·∫ßn)
    - [**4. C·∫•u h√¨nh MySQL ƒë·ªÉ t·ªëi ∆∞u Transaction**](#4-c·∫•u-h√¨nh-mysql-ƒë·ªÉ-t·ªëi-∆∞u-transaction)
      - [**4.1. TƒÉng b·ªô nh·ªõ InnoDB Buffer Pool**](#41-tƒÉng-b·ªô-nh·ªõ-innodb-buffer-pool)
      - [**4.2. Ki·ªÉm tra v√† t·ªëi ∆∞u transaction log**](#42-ki·ªÉm-tra-v√†-t·ªëi-∆∞u-transaction-log)
      - [**4.3. Gi·ªõi h·∫°n th·ªùi gian transaction (`innodb_lock_wait_timeout`)**](#43-gi·ªõi-h·∫°n-th·ªùi-gian-transaction-innodb_lock_wait_timeout)
    - [**5. K·∫øt h·ª£p Transaction v√† Queue ƒë·ªÉ tƒÉng hi·ªáu su·∫•t**](#5-k·∫øt-h·ª£p-transaction-v√†-queue-ƒë·ªÉ-tƒÉng-hi·ªáu-su·∫•t)
  - [**üîç T·ªïng k·∫øt ‚Äì C√°ch t·ªëi ∆∞u Transaction hi·ªáu qu·∫£**](#-t·ªïng-k·∫øt--c√°ch-t·ªëi-∆∞u-transaction-hi·ªáu-qu·∫£)
  - [**Lock trong MySQL: Khi n√†o x·∫£y ra v√† c√°c lo·∫°i Transaction**](#lock-trong-mysql-khi-n√†o-x·∫£y-ra-v√†-c√°c-lo·∫°i-transaction)
  - [**1. Khi n√†o MySQL x·∫£y ra Lock?**](#1-khi-n√†o-mysql-x·∫£y-ra-lock)
      - [**1.1. Khi c√≥ thao t√°c ƒë·ªçc v√† ghi ƒë·ªìng th·ªùi**](#11-khi-c√≥-thao-t√°c-ƒë·ªçc-v√†-ghi-ƒë·ªìng-th·ªùi)
      - [**1.2. Khi d√πng c√°c c√¢u l·ªánh sau**](#12-khi-d√πng-c√°c-c√¢u-l·ªánh-sau)
  - [**2. C√°c lo·∫°i Lock trong MySQL**](#2-c√°c-lo·∫°i-lock-trong-mysql)
    - [**2.1. Table Lock (Kh√≥a b·∫£ng)**](#21-table-lock-kh√≥a-b·∫£ng)
    - [**2.2. Row Lock (Kh√≥a d√≤ng - InnoDB)**](#22-row-lock-kh√≥a-d√≤ng---innodb)
    - [**2.3. Shared Lock (Kh√≥a chia s·∫ª - S)**](#23-shared-lock-kh√≥a-chia-s·∫ª---s)
    - [**2.4. Exclusive Lock (Kh√≥a ƒë·ªôc quy·ªÅn - X)**](#24-exclusive-lock-kh√≥a-ƒë·ªôc-quy·ªÅn---x)
    - [**2.5. Gap Lock (Kh√≥a kho·∫£ng - InnoDB)**](#25-gap-lock-kh√≥a-kho·∫£ng---innodb)
  - [**3. C√°c lo·∫°i Transaction Isolation Levels trong MySQL**](#3-c√°c-lo·∫°i-transaction-isolation-levels-trong-mysql)
  - [**4. T·ªïng k·∫øt ‚Äì C√°ch tr√°nh Lock v√† t·ªëi ∆∞u Transaction**](#4-t·ªïng-k·∫øt--c√°ch-tr√°nh-lock-v√†-t·ªëi-∆∞u-transaction)
  - [**C√°c lo·∫°i Transaction trong MySQL ‚Äì Chi ti·∫øt v√† V√≠ d·ª• C·ª• th·ªÉ**](#c√°c-lo·∫°i-transaction-trong-mysql--chi-ti·∫øt-v√†-v√≠-d·ª•-c·ª•-th·ªÉ)
  - [**1. C√°c lo·∫°i Transaction trong MySQL**](#1-c√°c-lo·∫°i-transaction-trong-mysql)
    - [**1.1. Implicit Transaction (Giao d·ªãch ng·∫ßm ƒë·ªãnh)**](#11-implicit-transaction-giao-d·ªãch-ng·∫ßm-ƒë·ªãnh)
    - [**1.2. Explicit Transaction (Giao d·ªãch t∆∞·ªùng minh)**](#12-explicit-transaction-giao-d·ªãch-t∆∞·ªùng-minh)
    - [**1.3. Savepoint Transaction (Giao d·ªãch c√≥ ƒëi·ªÉm l∆∞u)**](#13-savepoint-transaction-giao-d·ªãch-c√≥-ƒëi·ªÉm-l∆∞u)
    - [**1.4. Chained Transaction (Giao d·ªãch li√™n k·∫øt)**](#14-chained-transaction-giao-d·ªãch-li√™n-k·∫øt)
    - [**1.5. Distributed Transaction (Giao d·ªãch ph√¢n t√°n)**](#15-distributed-transaction-giao-d·ªãch-ph√¢n-t√°n)
  - [**2. So s√°nh c√°c lo·∫°i Transaction**](#2-so-s√°nh-c√°c-lo·∫°i-transaction)
  - [**3. C√°ch t·ªëi ∆∞u Transaction ƒë·ªÉ tr√°nh Lock v√† Deadlock**](#3-c√°ch-t·ªëi-∆∞u-transaction-ƒë·ªÉ-tr√°nh-lock-v√†-deadlock)
  - [**4. K·∫øt lu·∫≠n**](#4-k·∫øt-lu·∫≠n)
  - [**C√°c Ch·∫ø ƒê·ªô (Mode) c·ªßa Transaction trong MySQL**](#c√°c-ch·∫ø-ƒë·ªô-mode-c·ªßa-transaction-trong-mysql)
  - [**1. C√°c Ch·∫ø ƒê·ªô Isolation c·ªßa Transaction (Isolation Levels)**](#1-c√°c-ch·∫ø-ƒë·ªô-isolation-c·ªßa-transaction-isolation-levels)
    - [**2. Chi Ti·∫øt T·ª´ng Ch·∫ø ƒê·ªô Isolation**](#2-chi-ti·∫øt-t·ª´ng-ch·∫ø-ƒë·ªô-isolation)
      - [**2.1. READ UNCOMMITTED (ƒê·ªçc d·ªØ li·ªáu ch∆∞a commit)**](#21-read-uncommitted-ƒë·ªçc-d·ªØ-li·ªáu-ch∆∞a-commit)
      - [**2.2. READ COMMITTED (Ch·ªâ ƒë·ªçc d·ªØ li·ªáu ƒë√£ commit)**](#22-read-committed-ch·ªâ-ƒë·ªçc-d·ªØ-li·ªáu-ƒë√£-commit)
      - [**2.3. REPEATABLE READ (M·∫∑c ƒë·ªãnh trong MySQL)**](#23-repeatable-read-m·∫∑c-ƒë·ªãnh-trong-mysql)
      - [**2.4. SERIALIZABLE (M·ª©c c√¥ l·∫≠p cao nh·∫•t)**](#24-serializable-m·ª©c-c√¥-l·∫≠p-cao-nh·∫•t)
  - [**3. C√°c Ch·∫ø ƒê·ªô Truy C·∫≠p (Access Mode)**](#3-c√°c-ch·∫ø-ƒë·ªô-truy-c·∫≠p-access-mode)
  - [**4. Ch·ªçn Ch·∫ø ƒê·ªô Isolation Ph√π H·ª£p**](#4-ch·ªçn-ch·∫ø-ƒë·ªô-isolation-ph√π-h·ª£p)
  - [**5. T·ªëi ∆Øu Transaction ƒë·ªÉ Tr√°nh Lock v√† Deadlock**](#5-t·ªëi-∆∞u-transaction-ƒë·ªÉ-tr√°nh-lock-v√†-deadlock)
  - [**6. K·∫øt Lu·∫≠n**](#6-k·∫øt-lu·∫≠n)
  - [**Access Mode trong MySQL Transactions**](#access-mode-trong-mysql-transactions)
  - [**1. READ WRITE Mode (M·∫∑c ƒë·ªãnh)**](#1-read-write-mode-m·∫∑c-ƒë·ªãnh)
  - [**2. READ ONLY Mode**](#2-read-only-mode)
  - [**3. Khi n√†o s·ª≠ d·ª•ng READ ONLY?**](#3-khi-n√†o-s·ª≠-d·ª•ng-read-only)
  - [**4. So s√°nh READ WRITE vs READ ONLY**](#4-so-s√°nh-read-write-vs-read-only)
  - [**5. K·∫øt lu·∫≠n**](#5-k·∫øt-lu·∫≠n)
  - [**1. SAVEPOINT v√† ROLLBACK TO SAVEPOINT**](#1-savepoint-v√†-rollback-to-savepoint)
      - [üîπ **Cho ph√©p rollback m·ªôt ph·∫ßn transaction thay v√¨ to√†n b·ªô.**](#-cho-ph√©p-rollback-m·ªôt-ph·∫ßn-transaction-thay-v√¨-to√†n-b·ªô)
  - [**2. DEADLOCK: C√°ch ph√°t hi·ªán v√† tr√°nh**](#2-deadlock-c√°ch-ph√°t-hi·ªán-v√†-tr√°nh)
      - [üîπ **Deadlock x·∫£y ra khi 2 transaction ch·ªù nhau gi·∫£i ph√≥ng t√†i nguy√™n.**](#-deadlock-x·∫£y-ra-khi-2-transaction-ch·ªù-nhau-gi·∫£i-ph√≥ng-t√†i-nguy√™n)
      - [‚úÖ **C√°ch tr√°nh Deadlock**](#-c√°ch-tr√°nh-deadlock-1)
  - [**3. GROUP COMMIT: T·ªëi ∆∞u hi·ªáu su·∫•t COMMIT**](#3-group-commit-t·ªëi-∆∞u-hi·ªáu-su·∫•t-commit)
      - [üîπ **Group Commit gi√∫p gi·∫£m th·ªùi gian disk I/O khi c√≥ nhi·ªÅu transaction c√πng l√∫c.**](#-group-commit-gi√∫p-gi·∫£m-th·ªùi-gian-disk-io-khi-c√≥-nhi·ªÅu-transaction-c√πng-l√∫c)
  - [**4. MULTI-STATEMENT TRANSACTION: Th·ª±c thi nhi·ªÅu l·ªánh trong m·ªôt transaction**](#4-multi-statement-transaction-th·ª±c-thi-nhi·ªÅu-l·ªánh-trong-m·ªôt-transaction)
      - [üîπ **Gi·∫£m s·ªë l·∫ßn g·ª≠i l·ªánh t·ª´ ·ª©ng d·ª•ng ƒë·∫øn MySQL, tƒÉng t·ªëc ƒë·ªô x·ª≠ l√Ω.**](#-gi·∫£m-s·ªë-l·∫ßn-g·ª≠i-l·ªánh-t·ª´-·ª©ng-d·ª•ng-ƒë·∫øn-mysql-tƒÉng-t·ªëc-ƒë·ªô-x·ª≠-l√Ω)
  - [**5. PARTITION TABLE: Chia b·∫£ng l·ªõn th√†nh nhi·ªÅu ph·∫ßn nh·ªè**](#5-partition-table-chia-b·∫£ng-l·ªõn-th√†nh-nhi·ªÅu-ph·∫ßn-nh·ªè)
      - [üîπ **Gi·∫£m t·∫£i cho index v√† t·ªëi ∆∞u truy v·∫•n khi b·∫£ng qu√° l·ªõn.**](#-gi·∫£m-t·∫£i-cho-index-v√†-t·ªëi-∆∞u-truy-v·∫•n-khi-b·∫£ng-qu√°-l·ªõn)
  - [**6. VIRTUAL COLUMN: C·ªôt ·∫£o gi√∫p t·ªëi ∆∞u truy v·∫•n**](#6-virtual-column-c·ªôt-·∫£o-gi√∫p-t·ªëi-∆∞u-truy-v·∫•n)
      - [üîπ **T·∫°o c·ªôt d·ª±a tr√™n bi·ªÉu th·ª©c, gi·∫£m chi ph√≠ l∆∞u tr·ªØ nh∆∞ng v·∫´n c√≥ index.**](#-t·∫°o-c·ªôt-d·ª±a-tr√™n-bi·ªÉu-th·ª©c-gi·∫£m-chi-ph√≠-l∆∞u-tr·ªØ-nh∆∞ng-v·∫´n-c√≥-index)
  - [**7. TUNING TRANSACTIONS: Tinh ch·ªânh MySQL ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t**](#7-tuning-transactions-tinh-ch·ªânh-mysql-ƒë·ªÉ-t·ªëi-∆∞u-hi·ªáu-su·∫•t)
      - [üîπ **M·ªôt s·ªë tham s·ªë quan tr·ªçng c·∫ßn ƒëi·ªÅu ch·ªânh**](#-m·ªôt-s·ªë-tham-s·ªë-quan-tr·ªçng-c·∫ßn-ƒëi·ªÅu-ch·ªânh)
  - [**K·∫æT LU·∫¨N**](#k·∫øt-lu·∫≠n)

------------

# C√¢u H·ªèi Ph·ªèng V·∫•n MySQL

## 1. MySQL l√† g√¨?
**Tr·∫£ l·ªùi:**
MySQL l√† h·ªá qu·∫£n tr·ªã c∆° s·ªü d·ªØ li·ªáu quan h·ªá (RDBMS) ngu·ªìn m·ªü, ƒë∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i trong c√°c ·ª©ng d·ª•ng web. N√≥ s·ª≠ d·ª•ng SQL (Structured Query Language) ƒë·ªÉ qu·∫£n l√Ω d·ªØ li·ªáu. MySQL h·ªó tr·ª£ nhi·ªÅu t√≠nh nƒÉng nh∆∞ replication, clustering, stored procedures, triggers v√† views.

## 2. C√°c lo·∫°i JOIN trong MySQL?
**Tr·∫£ l·ªùi:**
### 1. INNER JOIN
- Tr·∫£ v·ªÅ c√°c b·∫£n ghi c√≥ trong c·∫£ hai b·∫£ng khi c√≥ ƒëi·ªÅu ki·ªán kh·ªõp.
- Lo·∫°i b·ªè c√°c b·∫£n ghi kh√¥ng c√≥ gi√° tr·ªã t∆∞∆°ng ·ª©ng trong b·∫£ng kia.
- **V√≠ d·ª•:**
  ```sql
  SELECT employees.id, employees.name, departments.name AS department_name
  FROM employees
  INNER JOIN departments ON employees.department_id = departments.id;
  ```

### 2. LEFT JOIN (LEFT OUTER JOIN)
- Tr·∫£ v·ªÅ t·∫•t c·∫£ b·∫£n ghi t·ª´ b·∫£ng b√™n tr√°i v√† c√°c b·∫£n ghi kh·ªõp t·ª´ b·∫£ng b√™n ph·∫£i.
- N·∫øu kh√¥ng c√≥ gi√° tr·ªã t∆∞∆°ng ·ª©ng ·ªü b·∫£ng b√™n ph·∫£i, s·∫Ω tr·∫£ v·ªÅ NULL.
- **V√≠ d·ª•:**
  ```sql
  SELECT employees.id, employees.name, departments.name AS department_name
  FROM employees
  LEFT JOIN departments ON employees.department_id = departments.id;
  ```

### 3. RIGHT JOIN (RIGHT OUTER JOIN)
- Tr·∫£ v·ªÅ t·∫•t c·∫£ b·∫£n ghi t·ª´ b·∫£ng b√™n ph·∫£i v√† c√°c b·∫£n ghi kh·ªõp t·ª´ b·∫£ng b√™n tr√°i.
- N·∫øu kh√¥ng c√≥ gi√° tr·ªã t∆∞∆°ng ·ª©ng ·ªü b·∫£ng b√™n tr√°i, s·∫Ω tr·∫£ v·ªÅ NULL.
- **V√≠ d·ª•:**
  ```sql
  SELECT employees.id, employees.name, departments.name AS department_name
  FROM employees
  RIGHT JOIN departments ON employees.department_id = departments.id;
  ```

### 4. FULL JOIN (FULL OUTER JOIN) *(MySQL kh√¥ng h·ªó tr·ª£ tr·ª±c ti·∫øp)*
- Tr·∫£ v·ªÅ t·∫•t c·∫£ b·∫£n ghi t·ª´ c·∫£ hai b·∫£ng, n·∫øu kh√¥ng c√≥ gi√° tr·ªã t∆∞∆°ng ·ª©ng th√¨ tr·∫£ v·ªÅ NULL.
- MySQL kh√¥ng h·ªó tr·ª£ `FULL JOIN`, nh∆∞ng c√≥ th·ªÉ m√¥ ph·ªèng b·∫±ng UNION.
- **V√≠ d·ª•:**
  ```sql
  SELECT employees.id, employees.name, departments.name AS department_name
  FROM employees
  LEFT JOIN departments ON employees.department_id = departments.id
  UNION
  SELECT employees.id, employees.name, departments.name AS department_name
  FROM employees
  RIGHT JOIN departments ON employees.department_id = departments.id;
  ```

### 5. CROSS JOIN
- K·∫øt h·ª£p t·∫•t c·∫£ c√°c b·∫£n ghi t·ª´ hai b·∫£ng (t√≠ch Descartes), kh√¥ng c√≥ ƒëi·ªÅu ki·ªán k·∫øt h·ª£p.
- S·ªë d√≤ng tr·∫£ v·ªÅ = s·ªë d√≤ng b·∫£ng A √ó s·ªë d√≤ng b·∫£ng B.
- **V√≠ d·ª•:**
  ```sql
  SELECT employees.name, departments.name AS department_name
  FROM employees
  CROSS JOIN departments;
  ```

### 6. SELF JOIN
- Th·ª±c hi·ªán JOIN ch√≠nh n√≥ b·∫±ng c√°ch t·∫°o ra alias.
- D√πng ƒë·ªÉ t√¨m m·ªëi quan h·ªá trong c√πng m·ªôt b·∫£ng, ch·∫≥ng h·∫°n nh∆∞ danh s√°ch c·∫•p tr√™n - c·∫•p d∆∞·ªõi.
- **V√≠ d·ª•:**
  ```sql
  SELECT e1.name AS employee, e2.name AS manager
  FROM employees e1
  LEFT JOIN employees e2 ON e1.manager_id = e2.id;
  ```

## 3. C√°ch ph√≤ng ch·ªëng SQL Injection trong MySQL?
**Tr·∫£ l·ªùi:**
SQL Injection x·∫£y ra khi ƒë·ªëi t∆∞·ª£ng nh·∫≠p d·ªØ li·ªáu c√≥ th·ªÉ thao t√°c c√¢u l·ªánh SQL. C√°c c√°ch ph√≤ng ch·ªëng bao g·ªìm:
- **S·ª≠ d·ª•ng Prepared Statements**: Tr√°nh vi·ªác gh√©p n·ªëi chu·ªói SQL tr·ª±c ti·∫øp.
- **S·ª≠ d·ª•ng ORM (Object-Relational Mapping)**: Nh∆∞ Sequelize, Hibernate ƒë·ªÉ tr√°nh l·ªói.
- **Ki·ªÉm tra v√† l·ªçc d·ªØ li·ªáu ƒë·∫ßu v√†o**: Kh√¥ng cho ph√©p k√Ω t·ª± ƒë·∫∑c bi·ªát khi nh·∫≠p d·ªØ li·ªáu.
- **H·∫°n ch·∫ø quy·ªÅn truy c·∫≠p v√†o database**: Ch·ªâ c·∫•p quy·ªÅn c·∫ßn thi·∫øt.
- **S·ª≠ d·ª•ng Web Application Firewall (WAF)**: NgƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.

## 4. Ch·ª©c nƒÉng c·ªßa INDEX trong MySQL?
**Tr·∫£ l·ªùi:**
INDEX gi√∫p tƒÉng t·ªëc ƒë·ªô truy v·∫•n trong MySQL b·∫±ng c√°ch t·∫°o ra m·ªôt c·∫•u tr√∫c d·ªØ li·ªáu ri√™ng bi·ªát ƒë·ªÉ t√¨m ki·∫øm nhanh h∆°n.

### Ph√¢n lo·∫°i INDEX trong MySQL:
1. **Primary Key Index**:
   - Ch·ªâ m·ª•c duy nh·∫•t v√† kh√¥ng th·ªÉ NULL.
   - M·ªói b·∫£ng ch·ªâ c√≥ m·ªôt Primary Key.
   - T·∫°o m·∫∑c ƒë·ªãnh khi khai b√°o PRIMARY KEY.
2. **Unique Index**:
   - ƒê·∫£m b·∫£o gi√° tr·ªã trong c·ªôt l√† duy nh·∫•t.
   - Cho ph√©p NULL nh∆∞ng ch·ªâ m·ªôt gi√° tr·ªã NULL.
   - C√∫ ph√°p:
     ```sql
     CREATE UNIQUE INDEX idx_unique_email ON employees(email);
     ```
3. **Full-text Index**:
   - D√πng cho t√¨m ki·∫øm vƒÉn b·∫£n (TEXT, VARCHAR).
   - Ch·ªâ h·ªó tr·ª£ trong MyISAM v√† InnoDB t·ª´ MySQL 5.6 tr·ªü l√™n.
   - C√∫ ph√°p:
     ```sql
     CREATE FULLTEXT INDEX idx_fulltext_name ON employees(name);
     ```
4. **Composite Index**:
   - Ch·ªâ m·ª•c tr√™n nhi·ªÅu c·ªôt, gi√∫p tƒÉng t·ªëc truy v·∫•n khi k·∫øt h·ª£p nhi·ªÅu c·ªôt trong ƒëi·ªÅu ki·ªán.
   - C√∫ ph√°p:
     ```sql
     CREATE INDEX idx_composite ON employees(department_id, name);
     ```
5. **Spatial Index**:
   - D√πng cho d·ªØ li·ªáu kh√¥ng gian (GIS).
   - Ch·ªâ h·ªó tr·ª£ tr√™n b·∫£ng MyISAM v√† InnoDB (MySQL 8.0 tr·ªü l√™n).
   - C√∫ ph√°p:
     ```sql
     CREATE SPATIAL INDEX idx_spatial_location ON locations(geo_point);
     ```

### So s√°nh c√°c lo·∫°i INDEX:
| Lo·∫°i INDEX        | ƒê·∫∑c ƒëi·ªÉm ch√≠nh | H·ªó tr·ª£ NULL | Khi n√†o s·ª≠ d·ª•ng? |
|-------------------|---------------|------------|----------------|
| **Primary Key**  | Ch·ªâ m·ª•c duy nh·∫•t, kh√¥ng NULL, duy nh·∫•t tr√™n b·∫£ng | Kh√¥ng | Khi c·∫ßn ƒë·ªãnh danh duy nh·∫•t cho m·ªói b·∫£n ghi |
| **Unique Index** | Ch·ªâ m·ª•c duy nh·∫•t, c√≥ th·ªÉ NULL | C√≥ | Khi c·∫ßn tr√°nh d·ªØ li·ªáu tr√πng l·∫∑p tr√™n c·ªôt |
| **Full-text Index** | D√πng ƒë·ªÉ t√¨m ki·∫øm vƒÉn b·∫£n | C√≥ | Khi c·∫ßn t√¨m ki·∫øm trong d·ªØ li·ªáu l·ªõn |
| **Composite Index** | T·ªëi ∆∞u truy v·∫•n v·ªõi nhi·ªÅu c·ªôt | T√πy v√†o t·ª´ng c·ªôt | Khi truy v·∫•n c√≥ ƒëi·ªÅu ki·ªán tr√™n nhi·ªÅu c·ªôt |
| **Spatial Index** | D√†nh cho d·ªØ li·ªáu kh√¥ng gian | Kh√¥ng | Khi l∆∞u tr·ªØ v√† truy v·∫•n d·ªØ li·ªáu ƒë·ªãa l√Ω |

### Khi n√†o n√™n s·ª≠ d·ª•ng INDEX?
- Khi truy v·∫•n d·ªØ li·ªáu tr√™n b·∫£ng c√≥ s·ªë l∆∞·ª£ng b·∫£n ghi l·ªõn.
- Khi c·ªôt ƒë∆∞·ª£c s·ª≠ d·ª•ng nhi·ªÅu trong ƒëi·ªÅu ki·ªán `WHERE`, `JOIN`, `ORDER BY`, `GROUP BY`.
- Khi c·∫ßn t√¨m ki·∫øm vƒÉn b·∫£n nhanh v·ªõi Full-Text Index.

### Khi n√†o KH√îNG n√™n s·ª≠ d·ª•ng INDEX?
- Khi b·∫£ng c√≥ √≠t d·ªØ li·ªáu, INDEX c√≥ th·ªÉ kh√¥ng mang l·∫°i l·ª£i √≠ch ƒë√°ng k·ªÉ.
- Khi c√≥ qu√° nhi·ªÅu INDEX tr√™n m·ªôt b·∫£ng, v√¨ ƒëi·ªÅu n√†y c√≥ th·ªÉ l√†m ch·∫≠m hi·ªáu su·∫•t INSERT, UPDATE, DELETE.
- Khi c·ªôt ch·ª©a qu√° nhi·ªÅu gi√° tr·ªã tr√πng l·∫∑p (INDEX hi·ªáu qu·∫£ h∆°n tr√™n c·ªôt c√≥ t√≠nh duy nh·∫•t cao).

## 5. S·ª± kh√°c nhau gi·ªØa MyISAM v√† InnoDB?
**Tr·∫£ l·ªùi:**
- **MyISAM**:
  - Kh√¥ng h·ªó tr·ª£ giao d·ªãch (ACID), kh√¥ng c√≥ kh√≥a ngo·∫°i.
  - H·ªó tr·ª£ FULLTEXT Index.
  - Nhanh h∆°n InnoDB trong c√°c truy v·∫•n ƒë·ªçc d·ªØ li·ªáu.
- **InnoDB**:
  - H·ªó tr·ª£ giao d·ªãch v·ªõi t√≠nh ACID ƒë·∫ßy ƒë·ªß.
  - C√≥ kh√≥a ngo·∫°i (Foreign Key) ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn d·ªØ li·ªáu.
  - H·ªó tr·ª£ kh√≥a d√≤ng (Row-level Locking) gi√∫p c·∫£i thi·ªán hi·ªáu su·∫•t khi c√≥ nhi·ªÅu giao d·ªãch ƒë·ªìng th·ªùi.

## 6. C√°c lo·∫°i r√†ng bu·ªôc (Constraints) trong MySQL?
**Tr·∫£ l·ªùi:**
- **NOT NULL**: C·ªôt kh√¥ng ƒë∆∞·ª£c ph√©p ch·ª©a gi√° tr·ªã NULL.
- **UNIQUE**: M·ªói gi√° tr·ªã trong c·ªôt ph·∫£i l√† duy nh·∫•t.
- **PRIMARY KEY**: K·∫øt h·ª£p gi·ªØa NOT NULL v√† UNIQUE, ch·ªâ c√≥ m·ªôt PRIMARY KEY tr√™n m·ªói b·∫£ng.
- **FOREIGN KEY**: R√†ng bu·ªôc tham chi·∫øu ƒë·∫øn kh√≥a ch√≠nh c·ªßa m·ªôt b·∫£ng kh√°c.
- **CHECK**: Ki·ªÉm tra ƒëi·ªÅu ki·ªán r√†ng bu·ªôc tr√™n m·ªôt c·ªôt (h·ªó tr·ª£ t·ª´ MySQL 8.0).
- **DEFAULT**: G√°n gi√° tr·ªã m·∫∑c ƒë·ªãnh n·∫øu kh√¥ng nh·∫≠p gi√° tr·ªã cho c·ªôt.

## 7. ACID trong MySQL l√† g√¨?
**Tr·∫£ l·ªùi:**
ACID l√† t·∫≠p h·ª£p c√°c thu·ªôc t√≠nh ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn c·ªßa giao d·ªãch trong c∆° s·ªü d·ªØ li·ªáu:
- **Atomicity**: Giao d·ªãch ph·∫£i ho√†n th√†nh to√†n b·ªô ho·∫∑c kh√¥ng c√≥ g√¨ thay ƒë·ªïi.
- **Consistency**: C∆° s·ªü d·ªØ li·ªáu ph·∫£i ·ªü tr·∫°ng th√°i h·ª£p l·ªá tr∆∞·ªõc v√† sau giao d·ªãch.
- **Isolation**: C√°c giao d·ªãch ph·∫£i ch·∫°y ƒë·ªôc l·∫≠p v·ªõi nhau.
- **Durability**: Khi giao d·ªãch ho√†n th√†nh, d·ªØ li·ªáu ph·∫£i ƒë∆∞·ª£c l∆∞u vƒ©nh vi·ªÖn.

---
# **T·ªëi ∆∞u h√≥a**
## **1. T·ªëi ∆∞u h√≥a thi·∫øt k·∫ø database (Database Schema Optimization)** 

T·ªëi ∆∞u h√≥a MySQL l√† m·ªôt qu√° tr√¨nh ph·ª©c t·∫°p, bao g·ªìm nhi·ªÅu kh√≠a c·∫°nh nh∆∞ thi·∫øt k·∫ø database, t·ªëi ∆∞u truy v·∫•n, t·ªëi ∆∞u h·ªá th·ªëng v√† s·ª≠ d·ª•ng cache. T√¥i s·∫Ω ph√¢n t√≠ch chi ti·∫øt t·ª´ng ph·∫ßn ƒë·ªÉ b·∫°n hi·ªÉu r√µ c√°ch √°p d·ª•ng trong th·ª±c t·∫ø.  

---
 
ƒê√¢y l√† b∆∞·ªõc quan tr·ªçng v√¨ m·ªôt thi·∫øt k·∫ø t·ªët ngay t·ª´ ƒë·∫ßu s·∫Ω gi√∫p h·ªá th·ªëng ch·∫°y nhanh h∆°n v√† ti·∫øt ki·ªám t√†i nguy√™n.  

### **1.1. Ch·ªçn ki·ªÉu d·ªØ li·ªáu ph√π h·ª£p**  
M·ªói ki·ªÉu d·ªØ li·ªáu trong MySQL c√≥ m·ª©c s·ª≠ d·ª•ng b·ªô nh·ªõ kh√°c nhau, v√¨ v·∫≠y c·∫ßn ch·ªçn lo·∫°i ph√π h·ª£p ƒë·ªÉ ti·∫øt ki·ªám t√†i nguy√™n v√† tƒÉng hi·ªáu su·∫•t.  

#### **üõ†Ô∏è Nguy√™n t·∫Øc ch·ªçn ki·ªÉu d·ªØ li·ªáu:**  
‚úÖ **D√πng ki·ªÉu d·ªØ li·ªáu nh·ªè nh·∫•t c√≥ th·ªÉ:**  
- `TINYINT` (1 byte) thay v√¨ `INT` (4 byte) n·∫øu ch·ªâ l∆∞u s·ªë nh·ªè (0-255 ho·∫∑c -128 ƒë·∫øn 127).  
- `SMALLINT` (2 byte) thay v√¨ `INT` n·∫øu ch·ªâ c·∫ßn l∆∞u t·ª´ -32,768 ƒë·∫øn 32,767.  
- `BIGINT` (8 byte) ch·ªâ n√™n d√πng khi th·ª±c s·ª± c·∫ßn s·ªë r·∫•t l·ªõn.  

‚úÖ **D√πng `VARCHAR` thay v√¨ `CHAR` n·∫øu ƒë·ªô d√†i thay ƒë·ªïi:**  
- `CHAR` lu√¥n chi·∫øm ƒë·ªß s·ªë k√Ω t·ª±, c√≤n `VARCHAR` ch·ªâ chi·∫øm ƒë√∫ng s·ªë k√Ω t·ª± ƒëang l∆∞u.  
- V√≠ d·ª•: `CHAR(50)` lu√¥n chi·∫øm **50 byte**, nh∆∞ng `VARCHAR(50)` ch·ªâ chi·∫øm **ƒë√∫ng s·ªë k√Ω t·ª± + 1 ho·∫∑c 2 byte l∆∞u ƒë·ªô d√†i**.  
- N√™n d√πng `CHAR` cho d·ªØ li·ªáu c√≥ ƒë·ªô d√†i c·ªë ƒë·ªãnh nh∆∞ m√£ qu·ªëc gia (`US`, `VN`, `JP`).  

‚úÖ **Tr√°nh s·ª≠ d·ª•ng `TEXT` v√† `BLOB` kh√¥ng c·∫ßn thi·∫øt**  
- `TEXT` v√† `BLOB` l∆∞u d·ªØ li·ªáu ngo√†i b·∫£ng ch√≠nh (`off-page storage`), l√†m ch·∫≠m truy v·∫•n.  
- N·∫øu d·ªØ li·ªáu nh·ªè, n√™n d√πng `VARCHAR(255)` thay v√¨ `TEXT`.  

##### **‚ùå V√≠ d·ª• k√©m t·ªëi ∆∞u:**
```sql
CREATE TABLE users (
    id INT NOT NULL AUTO_INCREMENT,
    name CHAR(255),   -- Kh√¥ng c·∫ßn thi·∫øt d√πng 255 k√Ω t·ª±
    email TEXT,       -- Email kh√¥ng c·∫ßn TEXT
    PRIMARY KEY (id)
);
```
##### **‚úÖ T·ªëi ∆∞u h∆°n:**
```sql
CREATE TABLE users (
    id INT UNSIGNED NOT NULL AUTO_INCREMENT,
    name VARCHAR(100),  -- Ch·ªâ d√πng ƒë·ªß
    email VARCHAR(255), -- Email th∆∞·ªùng d∆∞·ªõi 255 k√Ω t·ª±
    PRIMARY KEY (id)
);
```

---

### **1.2. B√¨nh th∆∞·ªùng h√≥a (Normalization) vs. Phi chu·∫©n h√≥a (Denormalization)**  
B√¨nh th∆∞·ªùng h√≥a gi√∫p lo·∫°i b·ªè d·ªØ li·ªáu tr√πng l·∫∑p, nh∆∞ng phi chu·∫©n h√≥a ƒë√¥i khi c·∫ßn ƒë·ªÉ tƒÉng hi·ªáu su·∫•t.  

**üéØ Quy t·∫Øc chung:**  
- N·∫øu h·ªá th·ªëng **ghi nhi·ªÅu (OLTP - Online Transaction Processing)** ‚Üí **D√πng b√¨nh th∆∞·ªùng h√≥a** ƒë·ªÉ gi·∫£m tr√πng l·∫∑p.  
- N·∫øu h·ªá th·ªëng **ƒë·ªçc nhi·ªÅu (OLAP - Online Analytical Processing)** ‚Üí **D√πng phi chu·∫©n h√≥a** ƒë·ªÉ gi·∫£m s·ªë l·∫ßn JOIN.  

‚úÖ **V√≠ d·ª• b√¨nh th∆∞·ªùng h√≥a:**  
```sql
CREATE TABLE customers (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100),
    email VARCHAR(255) UNIQUE
);

CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    customer_id INT,
    total DECIMAL(10,2),
    FOREIGN KEY (customer_id) REFERENCES customers(id)
);
```
- B·∫£ng `orders` ch·ªâ l∆∞u `customer_id`, kh√¥ng l·∫∑p l·∫°i t√™n/email kh√°ch h√†ng.  

‚úÖ **V√≠ d·ª• phi chu·∫©n h√≥a (tƒÉng t·ªëc b√°o c√°o doanh thu theo kh√°ch h√†ng):**  
```sql
CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    customer_id INT,
    customer_name VARCHAR(100),  -- L∆∞u th√™m t√™n kh√°ch h√†ng ƒë·ªÉ gi·∫£m JOIN
    total DECIMAL(10,2)
);
```
- D·ªØ li·ªáu c√≥ ch√∫t d∆∞ th·ª´a nh∆∞ng gi√∫p **truy v·∫•n nhanh h∆°n**.  

---

## **2. T·ªëi ∆∞u h√≥a ch·ªâ m·ª•c (Index Optimization)**  
Ch·ªâ m·ª•c gi√∫p MySQL t√¨m d·ªØ li·ªáu nhanh h∆°n, nh∆∞ng c·∫ßn d√πng ƒë√∫ng c√°ch.  

### **2.1. Khi n√†o n√™n s·ª≠ d·ª•ng ch·ªâ m·ª•c?**  
‚úÖ **C·ªôt ƒë∆∞·ª£c d√πng trong `WHERE`, `JOIN`, `ORDER BY`, `GROUP BY`**.  
‚úÖ **C·ªôt c√≥ t√≠nh duy nh·∫•t cao (vd: email, username)**.  
‚úÖ **C·ªôt l√† kh√≥a ch√≠nh ho·∫∑c kh√≥a ngo·∫°i**.  

‚ùå **Kh√¥ng n√™n t·∫°o ch·ªâ m·ª•c tr√™n:**  
- C·ªôt c√≥ **nhi·ªÅu gi√° tr·ªã tr√πng nhau** (vd: `status` ch·ªâ c√≥ `active`, `inactive`).  
- C·ªôt th∆∞·ªùng xuy√™n **b·ªã c·∫≠p nh·∫≠t** (vd: `views_count`).  

### **2.2. C√°c lo·∫°i ch·ªâ m·ª•c**  
- **PRIMARY KEY**: Ch·ªâ m·ª•c duy nh·∫•t tr√™n c·ªôt kh√≥a ch√≠nh.  
- **UNIQUE INDEX**: ƒê·∫£m b·∫£o kh√¥ng c√≥ gi√° tr·ªã tr√πng l·∫∑p.  
- **INDEX** (B-Tree Index): Ch·ªâ m·ª•c th√¥ng th∆∞·ªùng gi√∫p tƒÉng t·ªëc truy v·∫•n.  
- **FULLTEXT INDEX**: D√πng cho t√¨m ki·∫øm vƒÉn b·∫£n.  

##### **‚úÖ V√≠ d·ª• t·∫°o ch·ªâ m·ª•c:**
```sql
CREATE INDEX idx_email ON users(email);
CREATE INDEX idx_name ON users(first_name, last_name);
```

##### **üìä Ki·ªÉm tra MySQL c√≥ d√πng ch·ªâ m·ª•c kh√¥ng?**
```sql
EXPLAIN SELECT * FROM users WHERE email = 'test@example.com';
```
N·∫øu MySQL **kh√¥ng d√πng index**, c√≥ th·ªÉ c·∫ßn ki·ªÉm tra l·∫°i thi·∫øt k·∫ø ch·ªâ m·ª•c.  

---

## **3. T·ªëi ∆∞u h√≥a truy v·∫•n (Query Optimization)**  
- **Tr√°nh `SELECT *`**, ch·ªâ l·∫•y c·ªôt c·∫ßn thi·∫øt.  
- **D√πng `EXPLAIN` ƒë·ªÉ ki·ªÉm tra truy v·∫•n**.  
- **Tr√°nh `JOIN` qu√° nhi·ªÅu b·∫£ng** n·∫øu kh√¥ng c·∫ßn thi·∫øt.  
- **S·ª≠ d·ª•ng `LIMIT` h·ª£p l√Ω** khi l·∫•y d·ªØ li·ªáu l·ªõn.  

##### **‚ùå Truy v·∫•n k√©m t·ªëi ∆∞u:**
```sql
SELECT * FROM orders;
```
##### **‚úÖ Truy v·∫•n t·ªëi ∆∞u h∆°n:**
```sql
SELECT id, order_date, total FROM orders;
```

üìä **D√πng `EXPLAIN` ƒë·ªÉ ph√¢n t√≠ch truy v·∫•n:**
```sql
EXPLAIN SELECT id, order_date FROM orders WHERE total > 100;
```
N·∫øu **`type = ALL`**, nghƒ©a l√† MySQL ƒëang qu√©t to√†n b·ªô b·∫£ng ‚Üí C·∫ßn th√™m ch·ªâ m·ª•c.  

---

## **4. C·∫•u h√¨nh MySQL ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t**  
### **4.1. TƒÉng b·ªô nh·ªõ (`innodb_buffer_pool_size`)**  
```sql
SHOW VARIABLES LIKE 'innodb_buffer_pool_size';
SET GLOBAL innodb_buffer_pool_size = 1G;
```
- Gi√° tr·ªã n√†y n√™n chi·∫øm **70% - 80% RAM** n·∫øu ch·ªâ ch·∫°y MySQL.  

### **4.2. Gi·ªõi h·∫°n k·∫øt n·ªëi ƒë·ªÉ tr√°nh qu√° t·∫£i (`max_connections`)**  
```sql
SHOW VARIABLES LIKE 'max_connections';
SET GLOBAL max_connections = 500;
```

### **4.3. B·∫≠t b·ªô nh·ªõ cache (`query_cache_size`)** (ch·ªâ v·ªõi MySQL 5.7 tr·ªü xu·ªëng)  
```sql
SHOW VARIABLES LIKE 'query_cache_size';
SET GLOBAL query_cache_size = 64M;
```

---

## **5. D√πng Cache ƒë·ªÉ gi·∫£m t·∫£i MySQL**  
### **5.1. S·ª≠ d·ª•ng Redis ƒë·ªÉ cache k·∫øt qu·∫£ truy v·∫•n**  
```js
const redis = require('redis');
const client = redis.createClient();

async function getUserData(userId) {
    const cachedData = await client.get(`user:${userId}`);
    if (cachedData) return JSON.parse(cachedData);

    const user = await db.query('SELECT * FROM users WHERE id = ?', [userId]);
    client.setex(`user:${userId}`, 3600, JSON.stringify(user)); // L∆∞u cache trong 1 gi·ªù
    return user;
}
```

---

## **T√≥m t·∫Øt**
1. **T·ªëi ∆∞u thi·∫øt k·∫ø b·∫£ng** (ch·ªçn ki·ªÉu d·ªØ li·ªáu nh·ªè, chu·∫©n h√≥a h·ª£p l√Ω).  
2. **T·∫°o ch·ªâ m·ª•c ƒë√∫ng c√°ch** (cho `WHERE`, `JOIN`, `ORDER BY`).  
3. **Vi·∫øt truy v·∫•n t·ªëi ∆∞u** (`EXPLAIN`, tr√°nh `SELECT *`, t·ªëi ∆∞u `JOIN`).  
4. **C·∫•u h√¨nh MySQL h·ª£p l√Ω** (`innodb_buffer_pool_size`, `max_connections`).  
5. **D√πng cache v·ªõi Redis/Memcached** ƒë·ªÉ gi·∫£m truy v·∫•n MySQL.  

---

#### **Ph√¢n bi·ªát Index, FULLTEXT Index v√† Partitioning trong MySQL**  

Trong MySQL, `INDEX`, `FULLTEXT INDEX` v√† `PARTITIONING` ƒë·ªÅu l√† c√°c k·ªπ thu·∫≠t t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t, nh∆∞ng ch√∫ng c√≥ m·ª•c ƒë√≠ch kh√°c nhau. H√£y ƒëi s√¢u v√†o t·ª´ng lo·∫°i ƒë·ªÉ hi·ªÉu r√µ khi n√†o n√™n s·ª≠ d·ª•ng ch√∫ng.  

---

### **1. INDEX (B-Tree Index) ‚Äì Ch·ªâ m·ª•c th√¥ng th∆∞·ªùng**  
#### **1.1. M·ª•c ƒë√≠ch**  
- **TƒÉng t·ªëc truy v·∫•n** b·∫±ng c√°ch gi√∫p MySQL t√¨m ki·∫øm nhanh h∆°n thay v√¨ qu√©t to√†n b·ªô b·∫£ng.  
- Ho·∫°t ƒë·ªông d·ª±a tr√™n **c·∫•u tr√∫c c√¢y B-Tree**, gi√∫p t√¨m ki·∫øm theo kho·∫£ng gi√° tr·ªã nhanh.  
- D√πng cho c√°c c·ªôt trong `WHERE`, `JOIN`, `ORDER BY`, `GROUP BY`.  

#### **1.2. ƒê·∫∑c ƒëi·ªÉm**  
‚úÖ **T√¨m ki·∫øm nhanh h∆°n v·ªõi ƒëi·ªÅu ki·ªán so s√°nh (`=`, `>`, `<`, `LIKE 'abc%'`).**  
‚úÖ H·ªó tr·ª£ **multi-column index** (ch·ªâ m·ª•c nhi·ªÅu c·ªôt).  
‚úÖ D√πng cho d·ªØ li·ªáu d·∫°ng s·ªë, chu·ªói ng·∫Øn, ng√†y th√°ng.  
‚ùå **Kh√¥ng t·ªëi ∆∞u cho t√¨m ki·∫øm vƒÉn b·∫£n d√†i (vd: t√¨m ki·∫øm to√†n vƒÉn trong b√†i vi·∫øt).**  

#### **1.3. V√≠ d·ª•**  
##### **‚úÖ T·∫°o INDEX th√¥ng th∆∞·ªùng**  
```sql
CREATE INDEX idx_email ON users(email);
```
##### **üìä Ki·ªÉm tra MySQL c√≥ s·ª≠ d·ª•ng INDEX kh√¥ng?**
```sql
EXPLAIN SELECT * FROM users WHERE email = 'test@example.com';
```
- N·∫øu `type = ALL` ‚Üí MySQL ƒëang qu√©t to√†n b·ªô b·∫£ng, c·∫ßn ki·ªÉm tra l·∫°i ch·ªâ m·ª•c.  
- N·∫øu `type = ref` ho·∫∑c `type = range` ‚Üí Ch·ªâ m·ª•c ƒëang ho·∫°t ƒë·ªông t·ªët.  

---

### **2. FULLTEXT INDEX ‚Äì Ch·ªâ m·ª•c to√†n vƒÉn**  
#### **2.1. M·ª•c ƒë√≠ch**  
- **T·ªëi ∆∞u t√¨m ki·∫øm vƒÉn b·∫£n d√†i (vd: b√†i vi·∫øt, m√¥ t·∫£ s·∫£n ph·∫©m, b√¨nh lu·∫≠n, tin t·ª©c).**  
- Thay v√¨ so s√°nh t·ª´ng k√Ω t·ª± nh∆∞ `LIKE '%keyword%'`, MySQL d√πng **c√¥ng c·ª• ph√¢n t√≠ch ng·ªØ nghƒ©a** ƒë·ªÉ t√¨m k·∫øt qu·∫£ ph√π h·ª£p nh·∫•t.  
- H·ªó tr·ª£ **t√¨m ki·∫øm nhi·ªÅu t·ª´, g·∫ßn ƒë√∫ng, ho·∫∑c t√¨m ki·∫øm v·ªõi m·ª©c ƒë·ªô li√™n quan (`MATCH ... AGAINST`)**.  

#### **2.2. ƒê·∫∑c ƒëi·ªÉm**  
‚úÖ **Ch·ªâ ho·∫°t ƒë·ªông v·ªõi b·∫£ng InnoDB & MyISAM**.  
‚úÖ **T√¨m ki·∫øm vƒÉn b·∫£n t·ªët h∆°n `LIKE '%keyword%'`**.  
‚úÖ H·ªó tr·ª£ **t√¨m ki·∫øm t·ª± nhi√™n, Boolean, truy v·∫•n d·∫°ng vector**.  
‚ùå **Kh√¥ng ho·∫°t ƒë·ªông t·ªët v·ªõi d·ªØ li·ªáu s·ªë ho·∫∑c t√¨m ki·∫øm ch√≠nh x√°c (`=`).**  

#### **2.3. V√≠ d·ª•**  
##### **‚úÖ T·∫°o FULLTEXT INDEX**  
```sql
CREATE TABLE articles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255),
    content TEXT,
    FULLTEXT(title, content)  -- T·∫°o ch·ªâ m·ª•c to√†n vƒÉn
);
```
##### **‚úÖ T√¨m ki·∫øm to√†n vƒÉn**  
```sql
SELECT * FROM articles WHERE MATCH(title, content) AGAINST('MySQL Optimization');
```
##### **‚úÖ T√¨m ki·∫øm Boolean (AND, OR, NOT)**  
```sql
SELECT * FROM articles WHERE MATCH(title, content) AGAINST('+MySQL -PostgreSQL' IN BOOLEAN MODE);
```
üìå **L∆∞u √Ω:**  
- `+MySQL` (b·∫Øt bu·ªôc c√≥ t·ª´ "MySQL").  
- `-PostgreSQL` (lo·∫°i b·ªè t·ª´ "PostgreSQL").  

üìä **T·∫°i sao FULLTEXT t·ªët h∆°n `LIKE '%keyword%'`?**  
| **Ph∆∞∆°ng ph√°p** | **T·ªëc ƒë·ªô** | **H·ªó tr·ª£ ng·ªØ nghƒ©a** | **T√¨m ki·∫øm nhi·ªÅu t·ª´** |
|---------------|----------|----------------|----------------|
| `LIKE '%keyword%'` | Ch·∫≠m | ‚ùå Kh√¥ng | ‚ùå Kh√¥ng |
| `FULLTEXT` | Nhanh h∆°n | ‚úÖ C√≥ | ‚úÖ C√≥ |

---

### **3. PARTITIONING ‚Äì Chia nh·ªè b·∫£ng ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t**  
#### **3.1. M·ª•c ƒë√≠ch**  
- **TƒÉng t·ªëc truy v·∫•n v·ªõi b·∫£ng d·ªØ li·ªáu l·ªõn (h√†ng tri·ªáu ƒë·∫øn h√†ng t·ª∑ b·∫£n ghi).**  
- Chia b·∫£ng th√†nh nhi·ªÅu ph·∫ßn (`partition`), m·ªói ph·∫ßn l∆∞u tr√™n ·ªï ƒëƒ©a kh√°c nhau ƒë·ªÉ **tƒÉng t·ªëc t√¨m ki·∫øm v√† tr√°nh qu√° t·∫£i**.  
- H·ªØu √≠ch khi truy v·∫•n theo **ng√†y th√°ng, ID, ho·∫∑c danh m·ª•c c·ª• th·ªÉ**.  

#### **3.2. ƒê·∫∑c ƒëi·ªÉm**  
‚úÖ **TƒÉng hi·ªáu su·∫•t cho b·∫£ng l·ªõn b·∫±ng c√°ch chia nh·ªè d·ªØ li·ªáu.**  
‚úÖ **Ho·∫°t ƒë·ªông t·ªët v·ªõi truy v·∫•n l·ªçc (`WHERE partition_column = value`).**  
‚ùå **Kh√¥ng h·ªó tr·ª£ ch·ªâ m·ª•c tr√™n c·ªôt ƒë∆∞·ª£c partition.**  
‚ùå **Kh√¥ng h·ªó tr·ª£ `FOREIGN KEY`.**  

#### **3.3. C√°c lo·∫°i Partitioning**  
| **Lo·∫°i** | **M√¥ t·∫£** | **Khi n√†o d√πng?** |
|---------|---------|-----------------|
| **RANGE** | Chia theo kho·∫£ng gi√° tr·ªã (vd: nƒÉm, th√°ng) | Khi c√≥ d·ªØ li·ªáu theo th·ªùi gian |
| **LIST** | Chia theo danh s√°ch gi√° tr·ªã c·ª• th·ªÉ | Khi c√≥ d·ªØ li·ªáu theo nh√≥m x√°c ƒë·ªãnh |
| **HASH** | Chia theo gi√° tr·ªã bƒÉm (ng·∫´u nhi√™n) | Khi c·∫ßn chia ƒë·ªÅu d·ªØ li·ªáu |
| **KEY** | Gi·ªëng HASH nh∆∞ng do MySQL t·ª± t√≠nh to√°n | Khi kh√¥ng c√≥ c·ªôt s·ªë r√µ r√†ng ƒë·ªÉ chia |

#### **3.4. V√≠ d·ª•**  
##### **‚úÖ Partition theo nƒÉm (`RANGE`)**  
```sql
CREATE TABLE orders (
    id INT NOT NULL,
    order_date DATE NOT NULL,
    total DECIMAL(10,2) NOT NULL,
    PRIMARY KEY (id, order_date)
) PARTITION BY RANGE(YEAR(order_date)) (
    PARTITION p2019 VALUES LESS THAN (2020),
    PARTITION p2020 VALUES LESS THAN (2021),
    PARTITION p2021 VALUES LESS THAN (2022)
);
```
- L·ªánh tr√™n chia b·∫£ng `orders` th√†nh 3 ph·∫ßn d·ª±a tr√™n nƒÉm.  
- Khi t√¨m ki·∫øm `WHERE order_date >= '2020-01-01'`, MySQL **ch·ªâ qu√©t partition 2020 tr·ªü ƒëi** ‚Üí Truy v·∫•n nhanh h∆°n.  

##### **‚úÖ Partition theo khu v·ª±c (`LIST`)**  
```sql
CREATE TABLE customers (
    id INT NOT NULL,
    region VARCHAR(20) NOT NULL,
    PRIMARY KEY (id, region)
) PARTITION BY LIST COLUMNS(region) (
    PARTITION pNorth VALUES IN ('North America', 'Europe'),
    PARTITION pAsia VALUES IN ('China', 'Japan', 'India')
);
```
- N·∫øu t√¨m ki·∫øm kh√°ch h√†ng ·ªü `China`, MySQL ch·ªâ qu√©t partition `pAsia` thay v√¨ to√†n b·ªô b·∫£ng.  

---

## **üîç T·ªïng k·∫øt: N√™n d√πng lo·∫°i n√†o?**
| **Lo·∫°i** | **D√πng khi n√†o?** | **∆Øu ƒëi·ªÉm** | **Nh∆∞·ª£c ƒëi·ªÉm** |
|----------|-----------------|-------------|--------------|
| **INDEX (B-Tree)** | Khi t√¨m ki·∫øm d·ªØ li·ªáu ch√≠nh x√°c (`=`, `>`, `<`, `LIKE 'abc%'`). | TƒÉng t·ªëc t√¨m ki·∫øm v·ªõi c·ªôt c√≥ t√≠nh duy nh·∫•t cao. | Kh√¥ng t·ªëi ∆∞u cho t√¨m ki·∫øm vƒÉn b·∫£n d√†i. |
| **FULLTEXT INDEX** | Khi t√¨m ki·∫øm vƒÉn b·∫£n d√†i, m√¥ t·∫£ s·∫£n ph·∫©m, b√†i vi·∫øt. | H·ªó tr·ª£ t√¨m ki·∫øm nhi·ªÅu t·ª´, Boolean search. | Kh√¥ng ho·∫°t ƒë·ªông v·ªõi s·ªë v√† kh√¥ng h·ªó tr·ª£ JOIN t·ªët. |
| **PARTITIONING** | Khi b·∫£ng c√≥ d·ªØ li·ªáu r·∫•t l·ªõn (h√†ng tri·ªáu d√≤ng). | Truy v·∫•n nhanh h∆°n khi l·ªçc theo `WHERE`. | Kh√¥ng h·ªó tr·ª£ ch·ªâ m·ª•c tr√™n c·ªôt partition. |

---

üìå **K·∫øt lu·∫≠n:**  
- **T√¨m ki·∫øm ch√≠nh x√°c ‚Üí D√πng `INDEX`**.  
- **T√¨m ki·∫øm vƒÉn b·∫£n d√†i ‚Üí D√πng `FULLTEXT INDEX`**.  
- **D·ªØ li·ªáu qu√° l·ªõn ‚Üí D√πng `PARTITIONING`**.  

## **T·ªëi ∆∞u h√≥a Transaction trong MySQL**  
Transaction (giao d·ªãch) l√† m·ªôt t·∫≠p h·ª£p c√°c thao t√°c SQL ƒë∆∞·ª£c th·ª±c hi·ªán c√πng nhau ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu. N·∫øu m·ªôt thao t√°c th·∫•t b·∫°i, t·∫•t c·∫£ c√°c thao t√°c kh√°c trong transaction s·∫Ω b·ªã h·ªßy (`ROLLBACK`).  

Vi·ªác t·ªëi ∆∞u transaction gi√∫p **gi·∫£m lock, tƒÉng hi·ªáu su·∫•t, tr√°nh deadlock v√† c·∫£i thi·ªán ƒë·ªô tin c·∫≠y c·ªßa h·ªá th·ªëng**.  

---

### **1. Nguy√™n t·∫Øc c∆° b·∫£n c·ªßa Transaction trong MySQL**
#### **1.1. ACID ‚Äì 4 t√≠nh ch·∫•t quan tr·ªçng c·ªßa transaction**
üîπ **Atomicity (T√≠nh nguy√™n t·ª≠):** To√†n b·ªô transaction th√†nh c√¥ng ho·∫∑c b·ªã h·ªßy to√†n b·ªô.  
üîπ **Consistency (T√≠nh nh·∫•t qu√°n):** D·ªØ li·ªáu lu√¥n ·ªü tr·∫°ng th√°i h·ª£p l·ªá tr∆∞·ªõc v√† sau transaction.  
üîπ **Isolation (T√≠nh c√¥ l·∫≠p):** Transaction kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi transaction kh√°c ƒëang ch·∫°y.  
üîπ **Durability (T√≠nh b·ªÅn v·ªØng):** D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u vƒ©nh vi·ªÖn sau khi transaction `COMMIT`.  

#### **1.2. C√°c c√¢u l·ªánh transaction c∆° b·∫£n**
```sql
START TRANSACTION;  -- B·∫Øt ƒë·∫ßu transaction
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;  -- X√°c nh·∫≠n transaction
```
- N·∫øu m·ªôt b∆∞·ªõc th·∫•t b·∫°i, b·∫°n c√≥ th·ªÉ `ROLLBACK` ƒë·ªÉ h·ªßy to√†n b·ªô transaction.  

---

### **2. C√°c v·∫•n ƒë·ªÅ hi·ªáu su·∫•t khi s·ª≠ d·ª•ng Transaction**
Vi·ªác s·ª≠ d·ª•ng transaction kh√¥ng h·ª£p l√Ω c√≥ th·ªÉ l√†m ch·∫≠m h·ªá th·ªëng do **lock**, **deadlock**, v√† **gi·ªØ t√†i nguy√™n qu√° l√¢u**.  

### **2.1. Hi·ªán t∆∞·ª£ng Lock (Kh√≥a d·ªØ li·ªáu)**
#### **üîπ MySQL c√≥ hai lo·∫°i lock ch√≠nh:**
- **Table Lock:** Kh√≥a to√†n b·ªô b·∫£ng (th∆∞·ªùng th·∫•y ·ªü MyISAM).  
- **Row Lock:** Ch·ªâ kh√≥a c√°c d√≤ng li√™n quan (InnoDB h·ªó tr·ª£).  

‚úÖ **D√πng InnoDB ƒë·ªÉ h·ªó tr·ª£ Row Lock, tr√°nh kh√≥a to√†n b·ªô b·∫£ng!**  
```sql
ALTER TABLE accounts ENGINE = InnoDB;
```

‚úÖ **Tr√°nh SELECT ... FOR UPDATE khi kh√¥ng c·∫ßn thi·∫øt**  
```sql
START TRANSACTION;
SELECT balance FROM accounts WHERE id = 1 FOR UPDATE;  -- Lock d√≤ng n√†y
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
COMMIT;
```
- Ch·ªâ s·ª≠ d·ª•ng `FOR UPDATE` khi th·ª±c s·ª± c·∫ßn tr√°nh c·∫≠p nh·∫≠t ƒë·ªìng th·ªùi.  

---

### **2.2. Hi·ªán t∆∞·ª£ng Deadlock (Giao d·ªãch b·ªã k·∫πt nhau)**
Deadlock x·∫£y ra khi 2 transaction c√πng kh√≥a t√†i nguy√™n m√† b√™n kia c·∫ßn ƒë·ªÉ ti·∫øp t·ª•c.  

#### **üîπ V√≠ d·ª• deadlock:**
```sql
-- Transaction 1
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```
```sql
-- Transaction 2
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 2;
UPDATE accounts SET balance = balance + 100 WHERE id = 1;
COMMIT;
```
üö® **C·∫£ hai transaction ƒë·ªÅu ƒëang ch·ªù nhau gi·∫£i ph√≥ng lock ‚Üí Deadlock!**  

#### **üîπ C√°ch tr√°nh Deadlock**
‚úÖ **Lu√¥n c·∫≠p nh·∫≠t d·ªØ li·ªáu theo c√πng m·ªôt th·ª© t·ª± trong t·∫•t c·∫£ transaction**.  
‚úÖ **S·ª≠ d·ª•ng timeout cho transaction d√†i**:  
```sql
SET innodb_lock_wait_timeout = 5;  -- Ch·ªâ ch·ªù 5 gi√¢y n·∫øu b·ªã lock
```
‚úÖ **T√°ch nh·ªè transaction thay v√¨ c·∫≠p nh·∫≠t qu√° nhi·ªÅu d·ªØ li·ªáu c√πng l√∫c**.  

---

### **3. K·ªπ thu·∫≠t t·ªëi ∆∞u Transaction trong MySQL**
#### **3.1. Gi·∫£m th·ªùi gian gi·ªØ lock**
- Ch·ªâ `START TRANSACTION` khi th·ª±c s·ª± c·∫ßn.  
- Tr√°nh c√°c c√¢u l·ªánh `SELECT` k√©o d√†i trong transaction.  
- **Ch·ªët transaction nhanh ch√≥ng (`COMMIT` ho·∫∑c `ROLLBACK` s·ªõm nh·∫•t c√≥ th·ªÉ).**  
- H·∫°n ch·∫ø `UPDATE` ho·∫∑c `DELETE` tr√™n qu√° nhi·ªÅu h√†ng c√πng l√∫c.  

‚úÖ **V√≠ d·ª• t·ªëi ∆∞u h∆°n:**  
```sql
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;  -- K·∫øt th√∫c transaction ngay khi c√≥ th·ªÉ
```
üöÄ **Kh√¥ng gi·ªØ transaction m·ªü qu√° l√¢u!**

---

#### **3.2. S·ª≠ d·ª•ng Batch Processing thay v√¨ Transaction d√†i**
N·∫øu b·∫°n c·∫ßn c·∫≠p nh·∫≠t nhi·ªÅu b·∫£n ghi, thay v√¨ ch·∫°y nhi·ªÅu transaction, h√£y d√πng `BULK UPDATE` ho·∫∑c `INSERT`.  

‚úÖ **V√≠ d·ª• t·ªëi ∆∞u:**
```sql
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id IN (1, 2, 3, 4);
COMMIT;
```
‚è© **Nhanh h∆°n so v·ªõi vi·ªác ch·∫°y 4 transaction ri√™ng bi·ªát!**

---

#### **3.3. Ch·ªâ d√πng Transaction khi th·ª±c s·ª± c·∫ßn**
Kh√¥ng ph·∫£i thao t√°c n√†o c≈©ng c·∫ßn transaction.  
‚ùå **V√≠ d·ª• transaction kh√¥ng c·∫ßn thi·∫øt:**  
```sql
START TRANSACTION;
SELECT * FROM users WHERE id = 10;
COMMIT;
```
‚úÖ **Ch·ªâ c·∫ßn d√πng `SELECT` th√¥ng th∆∞·ªùng.**

---

### **4. C·∫•u h√¨nh MySQL ƒë·ªÉ t·ªëi ∆∞u Transaction**
#### **4.1. TƒÉng b·ªô nh·ªõ InnoDB Buffer Pool**
InnoDB s·ª≠ d·ª•ng b·ªô nh·ªõ cache (`innodb_buffer_pool_size`) ƒë·ªÉ gi·∫£m truy v·∫•n ƒëƒ©a.  
```sql
SHOW VARIABLES LIKE 'innodb_buffer_pool_size';
SET GLOBAL innodb_buffer_pool_size = 2G;  -- TƒÉng n·∫øu c√≥ nhi·ªÅu RAM
```
üìå **N√™n ƒë·∫∑t gi√° tr·ªã n√†y chi·∫øm kho·∫£ng 70% RAM n·∫øu ch·ªâ ch·∫°y MySQL.**

---

#### **4.2. Ki·ªÉm tra v√† t·ªëi ∆∞u transaction log**
MySQL ghi transaction v√†o log (`innodb_log_file_size`), n·∫øu log qu√° nh·ªè c√≥ th·ªÉ l√†m ch·∫≠m `COMMIT`.  
```sql
SHOW VARIABLES LIKE 'innodb_log_file_size';
SET GLOBAL innodb_log_file_size = 512M;
```
üìå **Gi√° tr·ªã t·ªëi ∆∞u th∆∞·ªùng l√† 25% t·ªïng `innodb_buffer_pool_size`.**

---

#### **4.3. Gi·ªõi h·∫°n th·ªùi gian transaction (`innodb_lock_wait_timeout`)**
N·∫øu transaction b·ªã lock qu√° l√¢u, n√≥ c√≥ th·ªÉ l√†m ch·∫≠m to√†n b·ªô h·ªá th·ªëng.  
```sql
SET GLOBAL innodb_lock_wait_timeout = 5;  -- Ch·ªâ ch·ªù 5 gi√¢y
```
‚úÖ **Tr√°nh tr∆∞·ªùng h·ª£p transaction b·ªã treo qu√° l√¢u.**

---

### **5. K·∫øt h·ª£p Transaction v√† Queue ƒë·ªÉ tƒÉng hi·ªáu su·∫•t**
Thay v√¨ ch·∫°y transaction ngay l·∫≠p t·ª©c, c√≥ th·ªÉ **ƒë·∫©y v√†o h√†ng ƒë·ª£i (queue) nh∆∞ RabbitMQ, Redis Queue** ƒë·ªÉ x·ª≠ l√Ω sau.  

‚úÖ **V√≠ d·ª• s·ª≠ d·ª•ng queue v·ªõi transaction trong Node.js (Sequelize):**
```javascript
async function transferMoney(userFrom, userTo, amount) {
    const transaction = await sequelize.transaction();
    try {
        await Account.update({ balance: sequelize.literal(`balance - ${amount}`) }, 
            { where: { id: userFrom }, transaction });

        await Account.update({ balance: sequelize.literal(`balance + ${amount}`) }, 
            { where: { id: userTo }, transaction });

        await transaction.commit();  // Ch·ªët transaction n·∫øu th√†nh c√¥ng
    } catch (error) {
        await transaction.rollback();  // H·ªßy n·∫øu c√≥ l·ªói
    }
}
```
üöÄ **C√°ch n√†y ƒë·∫£m b·∫£o transaction kh√¥ng gi·ªØ lock l√¢u v√† tr√°nh ·∫£nh h∆∞·ªüng hi·ªáu su·∫•t.**

---

## **üîç T·ªïng k·∫øt ‚Äì C√°ch t·ªëi ∆∞u Transaction hi·ªáu qu·∫£**
‚úÖ **Gi·ªØ transaction ng·∫Øn g·ªçn, tr√°nh gi·ªØ lock l√¢u**.  
‚úÖ **Lu√¥n c·∫≠p nh·∫≠t theo c√πng th·ª© t·ª± ƒë·ªÉ tr√°nh deadlock**.  
‚úÖ **S·ª≠ d·ª•ng Batch Processing thay v√¨ transaction d√†i**.  
‚úÖ **TƒÉng b·ªô nh·ªõ `innodb_buffer_pool_size` ƒë·ªÉ gi·∫£m I/O**.  
‚úÖ **Gi·ªõi h·∫°n `innodb_lock_wait_timeout` ƒë·ªÉ tr√°nh treo h·ªá th·ªëng**.  
‚úÖ **K·∫øt h·ª£p Queue ƒë·ªÉ x·ª≠ l√Ω transaction l·ªõn.**  

---

## **Lock trong MySQL: Khi n√†o x·∫£y ra v√† c√°c lo·∫°i Transaction**  
Trong MySQL, **lock (kh√≥a d·ªØ li·ªáu)** x·∫£y ra khi nhi·ªÅu transaction c√πng truy c·∫≠p ho·∫∑c thay ƒë·ªïi d·ªØ li·ªáu, nh·∫±m ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn v√† nh·∫•t qu√°n. N·∫øu lock kh√¥ng ƒë∆∞·ª£c qu·∫£n l√Ω t·ªët, n√≥ c√≥ th·ªÉ g√¢y ch·∫≠m hi·ªáu su·∫•t ho·∫∑c **deadlock** (giao d·ªãch b·ªã k·∫πt nhau).  

---

## **1. Khi n√†o MySQL x·∫£y ra Lock?**  
#### **1.1. Khi c√≥ thao t√°c ƒë·ªçc v√† ghi ƒë·ªìng th·ªùi**
- N·∫øu m·ªôt transaction ƒëang ƒë·ªçc (`SELECT ... FOR UPDATE` ho·∫∑c `LOCK IN SHARE MODE`), transaction kh√°c kh√¥ng th·ªÉ ghi v√†o d√≤ng ƒë√≥.  
- N·∫øu m·ªôt transaction ƒëang ghi (`INSERT`, `UPDATE`, `DELETE`), transaction kh√°c kh√¥ng th·ªÉ ƒë·ªçc ho·∫∑c ghi v√†o d√≤ng ƒë√≥ cho ƒë·∫øn khi n√≥ `COMMIT` ho·∫∑c `ROLLBACK`.  

#### **1.2. Khi d√πng c√°c c√¢u l·ªánh sau**
| **L·ªánh SQL** | **Lo·∫°i Lock** | **M√¥ t·∫£** |
|-------------|-------------|---------|
| `SELECT ... LOCK IN SHARE MODE` | **Shared Lock (S)** | Kh√¥ng ai c√≥ th·ªÉ s·ª≠a d·ªØ li·ªáu khi ƒëang ƒë·ªçc. |
| `SELECT ... FOR UPDATE` | **Exclusive Lock (X)** | Kh√≥a d·ªØ li·ªáu ƒë·ªÉ chu·∫©n b·ªã c·∫≠p nh·∫≠t. |
| `UPDATE`, `DELETE`, `INSERT` | **Exclusive Lock (X)** | Kh√≥a d√≤ng d·ªØ li·ªáu b·ªã t√°c ƒë·ªông. |
| `LOCK TABLES table_name WRITE` | **Table Lock** | Kh√≥a to√†n b·ªô b·∫£ng, kh√¥ng ai c√≥ th·ªÉ ƒë·ªçc ho·∫∑c ghi. |
| `LOCK TABLES table_name READ` | **Table Lock** | Ch·ªâ cho ph√©p ƒë·ªçc, kh√¥ng ai c√≥ th·ªÉ ghi. |

---

## **2. C√°c lo·∫°i Lock trong MySQL**  
### **2.1. Table Lock (Kh√≥a b·∫£ng)**
- **Kh√≥a to√†n b·ªô b·∫£ng**, kh√¥ng cho ph√©p thao t√°c ƒë·ªìng th·ªùi.  
- Th∆∞·ªùng x·∫£y ra tr√™n MyISAM (kh√¥ng h·ªó tr·ª£ kh√≥a d√≤ng).  
- D√πng khi c·∫ßn **ƒë·∫£m b·∫£o to√†n b·ªô b·∫£ng kh√¥ng b·ªã thay ƒë·ªïi** trong khi thao t√°c.  

‚úÖ **V√≠ d·ª• kh√≥a b·∫£ng**  
```sql
LOCK TABLES orders WRITE;   -- Ch·ªâ cho ph√©p ghi, kh√¥ng ai ƒë·ªçc ƒë∆∞·ª£c
UPDATE orders SET status = 'shipped' WHERE id = 1;
UNLOCK TABLES;
```

üö® **Nh∆∞·ª£c ƒëi·ªÉm**:  
- Gi·ªØ lock qu√° l√¢u c√≥ th·ªÉ g√¢y t·∫Øc ngh·∫Ωn.  
- H·∫°n ch·∫ø t√≠nh ƒë·ªìng th·ªùi khi nhi·ªÅu ng∆∞·ªùi d√πng truy v·∫•n c√πng l√∫c.  

---

### **2.2. Row Lock (Kh√≥a d√≤ng - InnoDB)**
- Ch·ªâ kh√≥a c√°c d√≤ng d·ªØ li·ªáu li√™n quan thay v√¨ to√†n b·ªô b·∫£ng.  
- **H·ªó tr·ª£ trong InnoDB**, gi√∫p tƒÉng t√≠nh ƒë·ªìng th·ªùi.  
- X·∫£y ra khi d√πng `SELECT ... FOR UPDATE`, `UPDATE`, `DELETE`.  

‚úÖ **V√≠ d·ª• kh√≥a d√≤ng**  
```sql
START TRANSACTION;
SELECT balance FROM accounts WHERE id = 1 FOR UPDATE;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
COMMIT;
```
üìå **Trong l√∫c n√†y, kh√¥ng transaction n√†o kh√°c c√≥ th·ªÉ ghi v√†o `accounts.id = 1`.**

üö® **Nh∆∞·ª£c ƒëi·ªÉm**:  
- N·∫øu nhi·ªÅu transaction c·ªë g·∫Øng c·∫≠p nh·∫≠t c√πng m·ªôt d√≤ng, c√≥ th·ªÉ d·∫´n ƒë·∫øn **deadlock**.  
- Khi truy v·∫•n qu√° nhi·ªÅu d√≤ng, **Row Lock c√≥ th·ªÉ bi·∫øn th√†nh Table Lock** (g·ªçi l√† **Gap Lock**).  

---

### **2.3. Shared Lock (Kh√≥a chia s·∫ª - S)**
- **Cho ph√©p nhi·ªÅu transaction ƒë·ªçc c√πng l√∫c**, nh∆∞ng kh√¥ng ai c√≥ th·ªÉ ghi.  
- D√πng `LOCK IN SHARE MODE`.  

‚úÖ **V√≠ d·ª• Shared Lock**  
```sql
START TRANSACTION;
SELECT * FROM products WHERE id = 1 LOCK IN SHARE MODE;
COMMIT;
```
üìå **C√°c transaction kh√°c c√≥ th·ªÉ ƒë·ªçc, nh∆∞ng kh√¥ng th·ªÉ UPDATE ho·∫∑c DELETE `products.id = 1`.**  

---

### **2.4. Exclusive Lock (Kh√≥a ƒë·ªôc quy·ªÅn - X)**
- **Kh√¥ng cho ph√©p ƒë·ªçc ho·∫∑c ghi ƒë·ªìng th·ªùi tr√™n d√≤ng b·ªã lock**.  
- X·∫£y ra khi d√πng `SELECT ... FOR UPDATE`.  

‚úÖ **V√≠ d·ª• Exclusive Lock**  
```sql
START TRANSACTION;
SELECT * FROM orders WHERE id = 5 FOR UPDATE;
UPDATE orders SET status = 'processing' WHERE id = 5;
COMMIT;
```
üìå **Kh√¥ng ai c√≥ th·ªÉ ƒë·ªçc `orders.id = 5` cho ƒë·∫øn khi transaction n√†y `COMMIT`.**  

---

### **2.5. Gap Lock (Kh√≥a kho·∫£ng - InnoDB)**
- **Kh√≥a kho·∫£ng gi·ªØa c√°c d√≤ng ƒë·ªÉ tr√°nh ch√®n d·ªØ li·ªáu m·ªõi.**  
- X·∫£y ra khi s·ª≠ d·ª•ng `SELECT ... FOR UPDATE` ho·∫∑c `UPDATE` tr√™n nhi·ªÅu d√≤ng.  

üö® **V√≠ d·ª• Deadlock do Gap Lock**  
```sql
-- Transaction 1
START TRANSACTION;
SELECT * FROM customers WHERE id BETWEEN 10 AND 20 FOR UPDATE;
```
```sql
-- Transaction 2
START TRANSACTION;
INSERT INTO customers (id, name) VALUES (15, 'John Doe');  -- B·ªã ch·∫∑n v√¨ b·ªã kh√≥a kho·∫£ng
```
üìå **Transaction 2 b·ªã k·∫πt v√¨ kho·∫£ng `id BETWEEN 10 AND 20` ƒë√£ b·ªã Transaction 1 kh√≥a!**  

‚úÖ **C√°ch tr√°nh:**  
- Ch·ªâ kh√≥a ƒë√∫ng d√≤ng c·∫ßn thi·∫øt.  
- D√πng `READ COMMITTED` thay v√¨ `REPEATABLE READ` ƒë·ªÉ gi·∫£m ph·∫°m vi Gap Lock.  
```sql
SET GLOBAL transaction_isolation = 'READ COMMITTED';
```

---

## **3. C√°c lo·∫°i Transaction Isolation Levels trong MySQL**  
**Transaction Isolation Level** quy·∫øt ƒë·ªãnh **m·ª©c ƒë·ªô ·∫£nh h∆∞·ªüng gi·ªØa c√°c transaction ch·∫°y song song**.  

| **Isolation Level** | **Hi·ªán t∆∞·ª£ng** | **T√°c ƒë·ªông ƒë·∫øn Lock** |
|--------------------|--------------|-------------------|
| **READ UNCOMMITTED** | C√≥ th·ªÉ ƒë·ªçc d·ªØ li·ªáu ch∆∞a commit (Dirty Read) | Kh√¥ng c√≥ lock, hi·ªáu su·∫•t cao nh∆∞ng kh√¥ng an to√†n. |
| **READ COMMITTED** | Ch·ªâ ƒë·ªçc d·ªØ li·ªáu ƒë√£ commit (Kh√¥ng c√≥ Dirty Read) | Ch·∫∑n ghi, nh∆∞ng kh√¥ng ch·∫∑n ƒë·ªçc d·ªØ li·ªáu ƒëang c·∫≠p nh·∫≠t. |
| **REPEATABLE READ** *(M·∫∑c ƒë·ªãnh InnoDB)* | M·ªçi l·∫ßn `SELECT` trong c√πng m·ªôt transaction ƒë·ªÅu th·∫•y d·ªØ li·ªáu nh∆∞ ban ƒë·∫ßu | D√πng **Gap Lock** ƒë·ªÉ ngƒÉn ch√®n d·ªØ li·ªáu m·ªõi. |
| **SERIALIZABLE** | T·∫•t c·∫£ transaction ch·∫°y tu·∫ßn t·ª±, kh√¥ng song song | **Kh√≥a to√†n b·ªô b·∫£ng**, ch·∫≠m nh∆∞ng an to√†n nh·∫•t. |

‚úÖ **V√≠ d·ª• thay ƒë·ªïi Isolation Level**  
```sql
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
START TRANSACTION;
SELECT * FROM orders WHERE id = 1 FOR UPDATE;
COMMIT;
```

üöÄ **Khi n√†o n√™n d√πng g√¨?**  
- **READ UNCOMMITTED** ‚Üí Khi ch·ªâ c·∫ßn hi·ªáu su·∫•t cao, kh√¥ng quan tr·ªçng ƒë·ªô ch√≠nh x√°c.  
- **READ COMMITTED** ‚Üí Khi c·∫ßn tr√°nh **Dirty Read** nh∆∞ng v·∫´n mu·ªën t·ªëc ƒë·ªô cao.  
- **REPEATABLE READ** (M·∫∑c ƒë·ªãnh) ‚Üí Khi c·∫ßn tr√°nh **Phantom Read** nh∆∞ng v·∫´n gi·ªØ hi·ªáu su·∫•t t·ªët.  
- **SERIALIZABLE** ‚Üí Khi c·∫ßn d·ªØ li·ªáu ch√≠nh x√°c tuy·ªát ƒë·ªëi (v√≠ d·ª•: x·ª≠ l√Ω ng√¢n h√†ng).  

---

## **4. T·ªïng k·∫øt ‚Äì C√°ch tr√°nh Lock v√† t·ªëi ∆∞u Transaction**
‚úÖ **S·ª≠ d·ª•ng InnoDB thay v√¨ MyISAM ƒë·ªÉ h·ªó tr·ª£ Row Lock.**  
‚úÖ **Tr√°nh gi·ªØ transaction qu√° l√¢u, commit s·ªõm nh·∫•t c√≥ th·ªÉ.**  
‚úÖ **Lu√¥n c·∫≠p nh·∫≠t d·ªØ li·ªáu theo c√πng th·ª© t·ª± ƒë·ªÉ tr√°nh Deadlock.**  
‚úÖ **Ch·ªâ kh√≥a d√≤ng khi c·∫ßn (d√πng `FOR UPDATE` thay v√¨ `LOCK TABLES`).**  
‚úÖ **D√πng Isolation Level ph√π h·ª£p v·ªõi ·ª©ng d·ª•ng.**  
‚úÖ **Tr√°nh Gap Lock b·∫±ng c√°ch d√πng `READ COMMITTED`.**  
‚úÖ **D√πng Queue (RabbitMQ, Redis Queue) ƒë·ªÉ gi·∫£m t·∫£i transaction ƒë·ªìng th·ªùi.**  

## **C√°c lo·∫°i Transaction trong MySQL ‚Äì Chi ti·∫øt v√† V√≠ d·ª• C·ª• th·ªÉ**  

Trong MySQL, **transaction** l√† m·ªôt t·∫≠p h·ª£p c√°c c√¢u l·ªánh SQL th·ª±c hi·ªán nh∆∞ m·ªôt ƒë∆°n v·ªã duy nh·∫•t ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.  
Khi l√†m vi·ªác v·ªõi transaction, c·∫ßn hi·ªÉu r√µ **c√°c lo·∫°i transaction** c≈©ng nh∆∞ **c√°ch ch√∫ng ·∫£nh h∆∞·ªüng ƒë·∫øn d·ªØ li·ªáu v√† lock**.  

---

## **1. C√°c lo·∫°i Transaction trong MySQL**  
### **1.1. Implicit Transaction (Giao d·ªãch ng·∫ßm ƒë·ªãnh)**
- M·ªói c√¢u l·ªánh SQL nh∆∞ `INSERT`, `UPDATE`, `DELETE` ƒë∆∞·ª£c MySQL coi l√† m·ªôt transaction ri√™ng l·∫ª.  
- **M·∫∑c ƒë·ªãnh, MySQL ch·∫°y ·ªü ch·∫ø ƒë·ªô Auto-Commit**, nghƒ©a l√† m·ªói l·ªánh SQL t·ª± ƒë·ªông `COMMIT` ngay sau khi th·ª±c hi·ªán.  

‚úÖ **V√≠ d·ª•:**  
```sql
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
```
üìå **M·ªói l·ªánh l√† m·ªôt transaction ri√™ng bi·ªát ‚Üí Kh√¥ng th·ªÉ `ROLLBACK` n·∫øu c√≥ l·ªói.**  

‚úÖ **T·∫Øt Auto-Commit ƒë·ªÉ ki·ªÉm so√°t transaction th·ªß c√¥ng:**  
```sql
SET autocommit = 0;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```

üöÄ **Nh∆∞·ª£c ƒëi·ªÉm:**  
- Kh√¥ng ƒë·∫£m b·∫£o t√≠nh nh·∫•t qu√°n n·∫øu m·ªôt l·ªánh b·ªã l·ªói gi·ªØa ch·ª´ng.  
- Kh√¥ng th·ªÉ th·ª±c hi·ªán `ROLLBACK` n·∫øu c√≥ l·ªói x·∫£y ra.  

---

### **1.2. Explicit Transaction (Giao d·ªãch t∆∞·ªùng minh)**
- Cho ph√©p **nh√≥m nhi·ªÅu c√¢u l·ªánh th√†nh m·ªôt transaction duy nh·∫•t**.  
- Ch·ªâ `COMMIT` khi t·∫•t c·∫£ c√¢u l·ªánh th√†nh c√¥ng, n·∫øu c√≥ l·ªói th√¨ `ROLLBACK`.  

‚úÖ **V√≠ d·ª• chuy·ªÉn ti·ªÅn (c√≥ ki·ªÉm so√°t l·ªói):**  
```sql
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```
üìå **N·∫øu b·∫•t k·ª≥ l·ªánh n√†o l·ªói, d·ªØ li·ªáu kh√¥ng b·ªã ·∫£nh h∆∞·ªüng (c√≥ th·ªÉ `ROLLBACK`).**  

üöÄ **∆Øu ƒëi·ªÉm:**  
- ƒê·∫£m b·∫£o d·ªØ li·ªáu nh·∫•t qu√°n n·∫øu c√≥ l·ªói.  
- C√≥ th·ªÉ ki·ªÉm so√°t vi·ªác `COMMIT` ho·∫∑c `ROLLBACK`.  

---

### **1.3. Savepoint Transaction (Giao d·ªãch c√≥ ƒëi·ªÉm l∆∞u)**
- **Cho ph√©p rollback t·ª´ng ph·∫ßn trong transaction**, thay v√¨ rollback to√†n b·ªô.  
- D√πng `SAVEPOINT` ƒë·ªÉ t·∫°o ƒëi·ªÉm kh√¥i ph·ª•c trong transaction.  

‚úÖ **V√≠ d·ª•:**  
```sql
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
SAVEPOINT before_second_update;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;

-- Gi·∫£ s·ª≠ l·ªánh th·ª© hai b·ªã l·ªói
ROLLBACK TO before_second_update;  -- Quay l·∫°i tr∆∞·ªõc khi update t√†i kho·∫£n 2
COMMIT;
```
üìå **T√†i kho·∫£n 1 ƒë√£ b·ªã tr·ª´ ti·ªÅn, nh∆∞ng t√†i kho·∫£n 2 ch∆∞a ƒë∆∞·ª£c c·ªông ti·ªÅn do l·ªói.**  

üöÄ **Khi n√†o n√™n d√πng?**  
- Khi c·∫ßn rollback m·ªôt ph·∫ßn d·ªØ li·ªáu m√† kh√¥ng ph·∫£i rollback to√†n b·ªô transaction.  
- Khi c√≥ nhi·ªÅu b∆∞·ªõc trong transaction v√† mu·ªën rollback linh ho·∫°t.  

---

### **1.4. Chained Transaction (Giao d·ªãch li√™n k·∫øt)**
- T·ª± ƒë·ªông b·∫Øt ƒë·∫ßu m·ªôt transaction m·ªõi sau khi `COMMIT` ho·∫∑c `ROLLBACK`.  

‚úÖ **V√≠ d·ª•:**  
```sql
SET autocommit = 0;
START TRANSACTION;
UPDATE orders SET status = 'shipped' WHERE id = 5;
COMMIT;  -- Transaction n√†y k·∫øt th√∫c, nh∆∞ng MySQL t·ª± b·∫Øt ƒë·∫ßu transaction m·ªõi
```
üìå **M·ªói l·∫ßn `COMMIT`, m·ªôt transaction m·ªõi ƒë∆∞·ª£c t·∫°o ngay l·∫≠p t·ª©c.**  

üöÄ **Khi n√†o d√πng?**  
- Khi l√†m vi·ªác v·ªõi nhi·ªÅu transaction n·ªëi ti·∫øp nhau m√† kh√¥ng c·∫ßn ph·∫£i `START TRANSACTION` th·ªß c√¥ng m·ªói l·∫ßn.  

---

### **1.5. Distributed Transaction (Giao d·ªãch ph√¢n t√°n)**
- Giao d·ªãch th·ª±c hi·ªán tr√™n **nhi·ªÅu c∆° s·ªü d·ªØ li·ªáu ho·∫∑c nhi·ªÅu server kh√°c nhau**.  
- D√πng **XA Transactions** ƒë·ªÉ ƒë·∫£m b·∫£o t·∫•t c·∫£ database tham gia ƒë·ªÅu commit th√†nh c√¥ng.  

‚úÖ **V√≠ d·ª• giao d·ªãch tr√™n nhi·ªÅu database kh√°c nhau:**  
```sql
XA START 'txn1';
UPDATE bank1.accounts SET balance = balance - 100 WHERE id = 1;
UPDATE bank2.accounts SET balance = balance + 100 WHERE id = 2;
XA END 'txn1';
XA PREPARE 'txn1';
XA COMMIT 'txn1';  -- Commit tr√™n c·∫£ hai database
```
üìå **N·∫øu m·ªôt l·ªánh l·ªói, c√≥ th·ªÉ rollback tr√™n c·∫£ hai database.**  

üöÄ **Khi n√†o d√πng?**  
- Khi l√†m vi·ªác v·ªõi **nhi·ªÅu database kh√°c nhau** (MySQL, PostgreSQL, MongoDB, v.v.).  
- Khi c·∫ßn ƒë·∫£m b·∫£o **t√≠nh to√†n v·∫πn d·ªØ li·ªáu gi·ªØa c√°c h·ªá th·ªëng kh√°c nhau**.  

---

## **2. So s√°nh c√°c lo·∫°i Transaction**  

| **Lo·∫°i Transaction** | **T√≠nh nƒÉng ch√≠nh** | **Khi n√†o d√πng?** |
|---------------------|-----------------|---------------|
| **Implicit** | T·ª± ƒë·ªông commit sau m·ªói l·ªánh | Khi kh√¥ng c·∫ßn rollback. |
| **Explicit** | Cho ph√©p `COMMIT` ho·∫∑c `ROLLBACK` th·ªß c√¥ng | Khi c·∫ßn ki·ªÉm so√°t t√≠nh to√†n v·∫πn d·ªØ li·ªáu. |
| **Savepoint** | Rollback t·ª´ng ph·∫ßn trong transaction | Khi c·∫ßn undo m·ªôt ph·∫ßn d·ªØ li·ªáu thay v√¨ to√†n b·ªô. |
| **Chained** | T·ª± ƒë·ªông b·∫Øt ƒë·∫ßu transaction m·ªõi sau khi commit | Khi l√†m vi·ªác v·ªõi nhi·ªÅu transaction li√™n ti·∫øp. |
| **Distributed (XA)** | Ch·∫°y tr√™n nhi·ªÅu database kh√°c nhau | Khi c·∫ßn giao d·ªãch gi·ªØa nhi·ªÅu server/database. |

---

## **3. C√°ch t·ªëi ∆∞u Transaction ƒë·ªÉ tr√°nh Lock v√† Deadlock**
‚úÖ **Lu√¥n COMMIT s·ªõm nh·∫•t c√≥ th·ªÉ** ƒë·ªÉ tr√°nh gi·ªØ lock qu√° l√¢u.  
‚úÖ **S·ª≠ d·ª•ng `ROW LOCK` thay v√¨ `TABLE LOCK`** ƒë·ªÉ tƒÉng hi·ªáu su·∫•t.  
‚úÖ **Lu√¥n c·∫≠p nh·∫≠t d·ªØ li·ªáu theo c√πng th·ª© t·ª± trong t·∫•t c·∫£ transaction** ƒë·ªÉ tr√°nh deadlock.  
‚úÖ **H·∫°n ch·∫ø `SELECT ... FOR UPDATE` n·∫øu kh√¥ng c·∫ßn thi·∫øt.**  
‚úÖ **D√πng `READ COMMITTED` thay v√¨ `REPEATABLE READ` ƒë·ªÉ gi·∫£m Gap Lock.**  

üìå **V√≠ d·ª• t·ªëi ∆∞u h√≥a giao d·ªãch ng√¢n h√†ng**  
```sql
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```
üöÄ **Gi·∫£m lock kh√¥ng c·∫ßn thi·∫øt, tr√°nh deadlock, v√† tƒÉng hi·ªáu su·∫•t!**  

---

## **4. K·∫øt lu·∫≠n**
üîπ **Implicit Transaction:** M·∫∑c ƒë·ªãnh, m·ªói c√¢u SQL l√† m·ªôt transaction.  
üîπ **Explicit Transaction:** C·∫ßn `START TRANSACTION` v√† `COMMIT`.  
üîπ **Savepoint Transaction:** Rollback t·ª´ng ph·∫ßn thay v√¨ to√†n b·ªô.  
üîπ **Chained Transaction:** T·ª± ƒë·ªông b·∫Øt ƒë·∫ßu transaction m·ªõi sau khi commit.  
üîπ **Distributed Transaction:** Giao d·ªãch tr√™n nhi·ªÅu database kh√°c nhau.  

‚úÖ **Ch·ªçn ƒë√∫ng lo·∫°i transaction gi√∫p ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn d·ªØ li·ªáu v√† tƒÉng hi·ªáu su·∫•t!**  

## **C√°c Ch·∫ø ƒê·ªô (Mode) c·ªßa Transaction trong MySQL**  

Trong MySQL, **c√°c ch·∫ø ƒë·ªô c·ªßa Transaction (Transaction Mode)** gi√∫p ki·ªÉm so√°t c√°ch d·ªØ li·ªáu ƒë∆∞·ª£c qu·∫£n l√Ω v√† lock trong qu√° tr√¨nh x·ª≠ l√Ω. MySQL h·ªó tr·ª£ c√°c **Isolation Levels** v√† **Access Modes** ƒë·ªÉ t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t v√† t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.  

---

## **1. C√°c Ch·∫ø ƒê·ªô Isolation c·ªßa Transaction (Isolation Levels)**  
Ch·∫ø ƒë·ªô **Isolation Level** quy ƒë·ªãnh m·ª©c ƒë·ªô **c√¥ l·∫≠p** gi·ªØa c√°c transaction. MySQL h·ªó tr·ª£ 4 c·∫•p ƒë·ªô:  

| **Isolation Level** | **Dirty Read** | **Non-Repeatable Read** | **Phantom Read** | **Hi·ªáu su·∫•t** |
|--------------------|--------------|------------------|--------------|--------------|
| **READ UNCOMMITTED** | ‚úÖ C√≥ | ‚úÖ C√≥ | ‚úÖ C√≥ | ‚ö° R·∫•t cao |
| **READ COMMITTED** | ‚ùå Kh√¥ng | ‚úÖ C√≥ | ‚úÖ C√≥ | üî• Cao |
| **REPEATABLE READ** (M·∫∑c ƒë·ªãnh MySQL) | ‚ùå Kh√¥ng | ‚ùå Kh√¥ng | ‚úÖ C√≥ | üîÑ Trung b√¨nh |
| **SERIALIZABLE** | ‚ùå Kh√¥ng | ‚ùå Kh√¥ng | ‚ùå Kh√¥ng | üê¢ Th·∫•p (Lock to√†n b·ªô b·∫£ng) |

üí° **Gi·∫£i th√≠ch c√°c v·∫•n ƒë·ªÅ:**  
- **Dirty Read:** ƒê·ªçc d·ªØ li·ªáu ch∆∞a commit c·ªßa transaction kh√°c.  
- **Non-Repeatable Read:** M·ªôt transaction ƒë·ªçc c√πng m·ªôt d√≤ng d·ªØ li·ªáu nhi·ªÅu l·∫ßn nh∆∞ng th·∫•y gi√° tr·ªã kh√°c nhau.  
- **Phantom Read:** Transaction A ƒë·ªçc m·ªôt t·∫≠p d·ªØ li·ªáu, Transaction B th√™m b·∫£n ghi m·ªõi, Transaction A ƒë·ªçc l·∫°i v√† th·∫•y kh√°c.  

‚úÖ **C√°ch thi·∫øt l·∫≠p Isolation Level:**  
```sql
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```

---

### **2. Chi Ti·∫øt T·ª´ng Ch·∫ø ƒê·ªô Isolation**  

#### **2.1. READ UNCOMMITTED (ƒê·ªçc d·ªØ li·ªáu ch∆∞a commit)**
- **Cho ph√©p ƒë·ªçc d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c commit** t·ª´ transaction kh√°c.  
- **Nguy c∆°:** Dirty Read ‚Üí Transaction ƒë·ªçc d·ªØ li·ªáu t·∫°m th·ªùi m√† c√≥ th·ªÉ b·ªã rollback.  

‚úÖ **V√≠ d·ª•:**  
```sql
-- Session 1: Ch∆∞a commit, nh∆∞ng Session 2 v·∫´n ƒë·ªçc ƒë∆∞·ª£c
START TRANSACTION;
UPDATE accounts SET balance = 1000 WHERE id = 1;
-- Kh√¥ng commit
```
```sql
-- Session 2: ƒê·ªçc gi√° tr·ªã ch∆∞a commit
SELECT balance FROM accounts WHERE id = 1;  -- K·∫øt qu·∫£: 1000 (c√≥ th·ªÉ b·ªã rollback sau ƒë√≥)
```

---

#### **2.2. READ COMMITTED (Ch·ªâ ƒë·ªçc d·ªØ li·ªáu ƒë√£ commit)**
- **Ch·ªâ ƒë·ªçc d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c commit** ‚Üí Kh√¥ng b·ªã dirty read.  
- **Nh∆∞·ª£c ƒëi·ªÉm:** Non-Repeatable Read ‚Üí N·∫øu transaction kh√°c update d·ªØ li·ªáu, ta ƒë·ªçc l·∫°i s·∫Ω th·∫•y gi√° tr·ªã thay ƒë·ªïi.  

‚úÖ **V√≠ d·ª•:**  
```sql
-- Session 1: Transaction 1 b·∫Øt ƒë·∫ßu
START TRANSACTION;
SELECT balance FROM accounts WHERE id = 1; -- Gi√° tr·ªã: 500

-- Session 2: Update r·ªìi commit
START TRANSACTION;
UPDATE accounts SET balance = 1000 WHERE id = 1;
COMMIT;
```
```sql
-- Session 1: ƒê·ªçc l·∫°i th·∫•y gi√° tr·ªã ƒë√£ thay ƒë·ªïi
SELECT balance FROM accounts WHERE id = 1; -- Gi√° tr·ªã: 1000 (kh√°c so v·ªõi l·∫ßn ƒë·∫ßu)
```

---

#### **2.3. REPEATABLE READ (M·∫∑c ƒë·ªãnh trong MySQL)**
- **D·ªØ li·ªáu ƒë·ªçc trong transaction kh√¥ng thay ƒë·ªïi, ngay c·∫£ khi transaction kh√°c update.**  
- **NgƒÉn Non-Repeatable Read, nh∆∞ng c√≥ th·ªÉ g·∫∑p Phantom Read.**  

‚úÖ **V√≠ d·ª•:**  
```sql
-- Session 1: Transaction 1 b·∫Øt ƒë·∫ßu
START TRANSACTION;
SELECT balance FROM accounts WHERE id = 1; -- Gi√° tr·ªã: 500

-- Session 2: Update r·ªìi commit
START TRANSACTION;
UPDATE accounts SET balance = 1000 WHERE id = 1;
COMMIT;
```
```sql
-- Session 1: ƒê·ªçc l·∫°i v·∫´n th·∫•y gi√° tr·ªã c≈© (500)
SELECT balance FROM accounts WHERE id = 1; -- Gi√° tr·ªã: 500 (v√¨ d√πng REPEATABLE READ)
```
üìå **D·ªØ li·ªáu trong transaction v·∫´n gi·ªØ nguy√™n ƒë·∫øn khi commit!**  

---

#### **2.4. SERIALIZABLE (M·ª©c c√¥ l·∫≠p cao nh·∫•t)**
- **Lock to√†n b·ªô b·∫£ng khi ƒë·ªçc d·ªØ li·ªáu ‚Üí Kh√¥ng c√≥ Dirty Read, Non-Repeatable Read, Phantom Read.**  
- **T·ªën t√†i nguy√™n ‚Üí Gi·∫£m hi·ªáu su·∫•t ƒë√°ng k·ªÉ.**  

‚úÖ **V√≠ d·ª•:**  
```sql
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
START TRANSACTION;
SELECT * FROM accounts WHERE balance > 100;
```
üìå **Transaction kh√°c kh√¥ng th·ªÉ update ho·∫∑c insert v√†o b·∫£ng n√†y cho ƒë·∫øn khi transaction ho√†n t·∫•t.**  

---

## **3. C√°c Ch·∫ø ƒê·ªô Truy C·∫≠p (Access Mode)**
Access Mode ki·ªÉm so√°t c√°ch transaction ƒë·ªçc v√† ghi d·ªØ li·ªáu.  

| **Access Mode** | **√ù nghƒ©a** | **Khi n√†o d√πng?** |
|--------------|-----------|----------------|
| **READ WRITE** (M·∫∑c ƒë·ªãnh) | C√≥ th·ªÉ ƒë·ªçc v√† ghi d·ªØ li·ªáu | Khi c·∫ßn thay ƒë·ªïi d·ªØ li·ªáu |
| **READ ONLY** | Ch·ªâ ƒë·ªçc, kh√¥ng th·ªÉ ghi d·ªØ li·ªáu | Khi ch·ªâ c·∫ßn ƒë·ªçc, kh√¥ng c·∫≠p nh·∫≠t d·ªØ li·ªáu |

‚úÖ **C√°ch thi·∫øt l·∫≠p READ ONLY**  
```sql
SET TRANSACTION READ ONLY;
START TRANSACTION;
SELECT * FROM accounts;
COMMIT;
```
üìå **TƒÉng hi·ªáu su·∫•t v√¨ kh√¥ng c·∫ßn lock d·ªØ li·ªáu ƒë·ªÉ ghi!**  

---

## **4. Ch·ªçn Ch·∫ø ƒê·ªô Isolation Ph√π H·ª£p**
| **Tr∆∞·ªùng h·ª£p** | **Isolation Level ph√π h·ª£p** |
|--------------|----------------------|
| **H·ªá th·ªëng c·∫ßn hi·ªáu su·∫•t cao, kh√¥ng quan t√¢m d·ªØ li·ªáu t·∫°m th·ªùi** | READ UNCOMMITTED |
| **H·ªá th·ªëng c·∫ßn ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·ªçc l√† d·ªØ li·ªáu ƒë√£ commit** | READ COMMITTED |
| **H·ªá th·ªëng giao d·ªãch t√†i ch√≠nh, kh√¥ng mu·ªën d·ªØ li·ªáu b·ªã thay ƒë·ªïi gi·ªØa transaction** | REPEATABLE READ (m·∫∑c ƒë·ªãnh) |
| **H·ªá th·ªëng y√™u c·∫ßu d·ªØ li·ªáu ch√≠nh x√°c tuy·ªát ƒë·ªëi, tr√°nh ho√†n to√†n l·ªói** | SERIALIZABLE |

---

## **5. T·ªëi ∆Øu Transaction ƒë·ªÉ Tr√°nh Lock v√† Deadlock**
‚úÖ **1. Lu√¥n COMMIT s·ªõm nh·∫•t c√≥ th·ªÉ** ƒë·ªÉ gi·∫£i ph√≥ng lock.  
‚úÖ **2. D√πng kh√≥a h√†ng (Row Lock) thay v√¨ kh√≥a b·∫£ng (Table Lock).**  
‚úÖ **3. C·∫≠p nh·∫≠t d·ªØ li·ªáu theo c√πng th·ª© t·ª± trong m·ªçi transaction ƒë·ªÉ tr√°nh deadlock.**  
‚úÖ **4. H·∫°n ch·∫ø s·ª≠ d·ª•ng `SELECT ... FOR UPDATE` n·∫øu kh√¥ng c·∫ßn thi·∫øt.**  
‚úÖ **5. D√πng `READ COMMITTED` thay v√¨ `REPEATABLE READ` n·∫øu kh√¥ng c·∫ßn d·ªØ li·ªáu c·ªë ƒë·ªãnh trong transaction.**  

üìå **V√≠ d·ª• t·ªëi ∆∞u giao d·ªãch ng√¢n h√†ng:**  
```sql
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```
üöÄ **Gi·∫£m lock kh√¥ng c·∫ßn thi·∫øt, tr√°nh deadlock, v√† tƒÉng hi·ªáu su·∫•t!**  

---

## **6. K·∫øt Lu·∫≠n**
- **Isolation Level** gi√∫p ki·ªÉm so√°t t√≠nh nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu.  
- **Access Mode** gi√∫p t·ªëi ∆∞u hi·ªáu su·∫•t khi ch·ªâ ƒë·ªçc d·ªØ li·ªáu.  
- **Ch·ªçn ƒë√∫ng Transaction Mode gi√∫p t·ªëi ∆∞u hi·ªáu su·∫•t v√† tr√°nh deadlock.**  

## **Access Mode trong MySQL Transactions**  

Access Mode trong MySQL quy·∫øt ƒë·ªãnh **transaction c√≥ th·ªÉ ƒë·ªçc v√† ghi d·ªØ li·ªáu hay kh√¥ng**. C√≥ hai ch·∫ø ƒë·ªô ch√≠nh:  

1. **READ WRITE (M·∫∑c ƒë·ªãnh)**
   - Cho ph√©p transaction **ƒë·ªçc v√† ghi d·ªØ li·ªáu**.
   - D√πng khi c·∫ßn c·∫≠p nh·∫≠t, x√≥a, ch√®n d·ªØ li·ªáu.  
   - M·∫∑c ƒë·ªãnh n·∫øu kh√¥ng ch·ªâ ƒë·ªãnh.  

2. **READ ONLY**  
   - **Ch·ªâ cho ph√©p ƒë·ªçc d·ªØ li·ªáu, kh√¥ng th·ªÉ ghi**.  
   - Gi·∫£m **lock**, tƒÉng hi·ªáu su·∫•t v·ªõi c√°c h·ªá th·ªëng ch·ªâ c·∫ßn ƒë·ªçc.  
   - H·ªØu √≠ch trong **b√°o c√°o, ph√¢n t√≠ch d·ªØ li·ªáu**.  

---

## **1. READ WRITE Mode (M·∫∑c ƒë·ªãnh)**
üîπ **ƒê·ªçc v√† ghi d·ªØ li·ªáu b√¨nh th∆∞·ªùng**.  
üîπ Transaction c√≥ th·ªÉ `INSERT`, `UPDATE`, `DELETE`.  

‚úÖ **V√≠ d·ª•:**  
```sql
SET TRANSACTION READ WRITE;
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```
üìå **N·∫øu c√≥ l·ªói trong qu√° tr√¨nh th·ª±c thi, c√≥ th·ªÉ ROLLBACK.**  

---

## **2. READ ONLY Mode**
üîπ **Ch·ªâ ƒë·ªçc d·ªØ li·ªáu, kh√¥ng cho ph√©p INSERT, UPDATE, DELETE.**  
üîπ **Gi√∫p tƒÉng hi·ªáu su·∫•t v√¨ MySQL kh√¥ng c·∫ßn theo d√µi thay ƒë·ªïi d·ªØ li·ªáu.**  
üîπ **H·∫°n ch·∫ø lock, tr√°nh xung ƒë·ªôt khi c√≥ nhi·ªÅu transaction ch·∫°y ƒë·ªìng th·ªùi.**  

‚úÖ **C√°ch thi·∫øt l·∫≠p:**  
```sql
SET TRANSACTION READ ONLY;
START TRANSACTION;
SELECT * FROM accounts WHERE balance > 500;
COMMIT;
```
üìå **Ch·ªâ c√≥ th·ªÉ th·ª±c hi·ªán SELECT, n·∫øu c·ªë ghi d·ªØ li·ªáu s·∫Ω b·ªã l·ªói.**  

üö® **V√≠ d·ª• th·ª≠ ghi d·ªØ li·ªáu trong READ ONLY Mode (S·∫Ω b·ªã l·ªói):**  
```sql
SET TRANSACTION READ ONLY;
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;  -- ‚ùå L·ªói!
COMMIT;
```
‚ö†Ô∏è **MySQL s·∫Ω b√°o l·ªói:**  
```
ERROR 1792 (HY000): Cannot execute statement in a READ ONLY transaction.
```

---

## **3. Khi n√†o s·ª≠ d·ª•ng READ ONLY?**
‚úÖ **D√πng khi c·∫ßn ƒë·ªçc d·ªØ li·ªáu m√† kh√¥ng mu·ªën thay ƒë·ªïi n√≥.**  
‚úÖ **Gi·∫£m lock, tƒÉng t·ªëc ƒë·ªô khi ch·∫°y truy v·∫•n l·ªõn.**  
‚úÖ **H·ªØu √≠ch trong c√°c h·ªá th·ªëng b√°o c√°o, dashboard, backup d·ªØ li·ªáu.**  

üìå **V√≠ d·ª•: Ch·∫°y b√°o c√°o m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn h·ªá th·ªëng ch√≠nh**  
```sql
SET TRANSACTION READ ONLY;
START TRANSACTION;
SELECT SUM(balance) FROM accounts WHERE balance > 500;
COMMIT;
```
üöÄ **TƒÉng hi·ªáu su·∫•t v√¨ MySQL kh√¥ng ph·∫£i lo x·ª≠ l√Ω lock ho·∫∑c rollback!**  

---

## **4. So s√°nh READ WRITE vs READ ONLY**

| **T√≠nh nƒÉng**          | **READ WRITE (M·∫∑c ƒë·ªãnh)** | **READ ONLY** |
|----------------------|-------------------|------------|
| **C√≥ th·ªÉ INSERT/UPDATE/DELETE?** | ‚úÖ C√≥ | ‚ùå Kh√¥ng |
| **C√≥ th·ªÉ SELECT?** | ‚úÖ C√≥ | ‚úÖ C√≥ |
| **Gi·∫£m lock v√† tƒÉng hi·ªáu su·∫•t?** | ‚ùå Kh√¥ng | ‚úÖ C√≥ |
| **D√πng cho transaction ghi d·ªØ li·ªáu?** | ‚úÖ C√≥ | ‚ùå Kh√¥ng |
| **D√πng cho b√°o c√°o, dashboard?** | ‚ùå Kh√¥ng | ‚úÖ C√≥ |

---

## **5. K·∫øt lu·∫≠n**
- **READ WRITE** ‚Üí **Cho ph√©p ghi d·ªØ li·ªáu**, d√πng cho c√°c transaction b√¨nh th∆∞·ªùng.  
- **READ ONLY** ‚Üí **Ch·ªâ ƒë·ªçc d·ªØ li·ªáu, tƒÉng hi·ªáu su·∫•t**, d√πng cho b√°o c√°o v√† ƒë·ªçc d·ªØ li·ªáu l·ªõn.  

C√≥ nhi·ªÅu ki·∫øn th·ª©c n√¢ng cao v·ªÅ **MySQL Transactions v√† t·ªëi ∆∞u h√≥a h·ªá th·ªëng** m√† b·∫°n c√≥ th·ªÉ quan t√¢m. D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë ch·ªß ƒë·ªÅ quan tr·ªçng gi√∫p b·∫°n n√¢ng cao hi·ªáu su·∫•t v√† ƒë·∫£m b·∫£o t√≠nh to√†n v·∫πn d·ªØ li·ªáu.  

---

## **1. SAVEPOINT v√† ROLLBACK TO SAVEPOINT**  
#### üîπ **Cho ph√©p rollback m·ªôt ph·∫ßn transaction thay v√¨ to√†n b·ªô.**  
- **Khi n√†o c·∫ßn d√πng?**  
  - Khi transaction ph·ª©c t·∫°p c√≥ nhi·ªÅu b∆∞·ªõc, nh∆∞ng ch·ªâ c·∫ßn rollback m·ªôt ph·∫ßn thay v√¨ to√†n b·ªô.  

‚úÖ **V√≠ d·ª•: D√πng SAVEPOINT ƒë·ªÉ rollback m·ªôt ph·∫ßn d·ªØ li·ªáu**  
```sql
START TRANSACTION;

UPDATE accounts SET balance = balance - 500 WHERE id = 1;
SAVEPOINT sp1;  -- L∆∞u tr·∫°ng th√°i

UPDATE accounts SET balance = balance - 300 WHERE id = 2;
SAVEPOINT sp2;  -- L∆∞u tr·∫°ng th√°i

-- N·∫øu x·∫£y ra l·ªói, ch·ªâ rollback ph·∫ßn sau SAVEPOINT sp1
ROLLBACK TO SAVEPOINT sp1;  -- Quay l·∫°i tr·∫°ng th√°i sp1, gi·ªØ nguy√™n thay ƒë·ªïi tr∆∞·ªõc ƒë√≥

COMMIT;  -- L∆∞u l·∫°i c√°c thay ƒë·ªïi c√≤n l·∫°i
```
üìå **TƒÉng ƒë·ªô linh ho·∫°t trong qu·∫£n l√Ω transaction, tr√°nh rollback to√†n b·ªô khi l·ªói nh·ªè.**

---

## **2. DEADLOCK: C√°ch ph√°t hi·ªán v√† tr√°nh**
#### üîπ **Deadlock x·∫£y ra khi 2 transaction ch·ªù nhau gi·∫£i ph√≥ng t√†i nguy√™n.**  
- **MySQL t·ª± ƒë·ªông ph√°t hi·ªán deadlock v√† rollback m·ªôt transaction.**  
- **Tuy nhi√™n, c·∫ßn t·ªëi ∆∞u ƒë·ªÉ tr√°nh b·ªã rollback!**  

‚úÖ **V√≠ d·ª• g√¢y ra Deadlock**  
```sql
-- Session 1
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
-- Ch·ªù v√†i gi√¢y...
UPDATE accounts SET balance = balance + 100 WHERE id = 2;

-- Session 2
START TRANSACTION;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
-- Ch·ªù v√†i gi√¢y...
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
```
üìå **C·∫£ hai transaction kh√≥a h√†ng v√† ch·ªù nhau ‚Üí Deadlock!**  

#### ‚úÖ **C√°ch tr√°nh Deadlock**
1. **Lu√¥n c·∫≠p nh·∫≠t d·ªØ li·ªáu theo c√πng m·ªôt th·ª© t·ª±** (v√≠ d·ª•: lu√¥n update `id=1` tr∆∞·ªõc `id=2`).  
2. **D√πng `SELECT ... FOR UPDATE` c·∫©n th·∫≠n** ƒë·ªÉ tr√°nh lock kh√¥ng c·∫ßn thi·∫øt.  
3. **Gi·ªØ transaction ng·∫Øn g·ªçn, commit s·ªõm nh·∫•t c√≥ th·ªÉ.**  
4. **D√πng InnoDB Engine thay v√¨ MyISAM** (MyISAM ch·ªâ h·ªó tr·ª£ table-level locking).  

---

## **3. GROUP COMMIT: T·ªëi ∆∞u hi·ªáu su·∫•t COMMIT**
#### üîπ **Group Commit gi√∫p gi·∫£m th·ªùi gian disk I/O khi c√≥ nhi·ªÅu transaction c√πng l√∫c.**  
- **MySQL ghi nhi·ªÅu transaction v√†o disk c√πng l√∫c thay v√¨ t·ª´ng c√°i m·ªôt.**  
- **Ho·∫°t ƒë·ªông khi d√πng InnoDB v√† Binary Log.**  

‚úÖ **C√°ch ki·ªÉm tra Group Commit c√≥ ho·∫°t ƒë·ªông kh√¥ng**  
```sql
SHOW VARIABLES LIKE 'innodb_flush_log_at_trx_commit';
SHOW VARIABLES LIKE 'sync_binlog';
```
üìå **N·∫øu c·∫£ hai gi√° tr·ªã n√†y l√† `1`, m·ªói COMMIT s·∫Ω ghi v√†o disk ngay l·∫≠p t·ª©c, gi·∫£m hi·ªáu su·∫•t.**  

‚úÖ **C√°ch tƒÉng hi·ªáu su·∫•t b·∫±ng Group Commit**
```sql
SET GLOBAL innodb_flush_log_at_trx_commit = 2;
SET GLOBAL sync_binlog = 0;
```
üöÄ **TƒÉng t·ªëc ƒë·ªô khi c√≥ nhi·ªÅu transaction m√† kh√¥ng m·∫•t qu√° nhi·ªÅu d·ªØ li·ªáu n·∫øu h·ªá th·ªëng g·∫∑p s·ª± c·ªë.**  

---

## **4. MULTI-STATEMENT TRANSACTION: Th·ª±c thi nhi·ªÅu l·ªánh trong m·ªôt transaction**
#### üîπ **Gi·∫£m s·ªë l·∫ßn g·ª≠i l·ªánh t·ª´ ·ª©ng d·ª•ng ƒë·∫øn MySQL, tƒÉng t·ªëc ƒë·ªô x·ª≠ l√Ω.**  
- **Thay v√¨ g·ª≠i t·ª´ng c√¢u l·ªánh SQL, g·ª≠i nhi·ªÅu l·ªánh c√πng l√∫c ƒë·ªÉ gi·∫£m overhead.**  

‚úÖ **V√≠ d·ª• v·ªõi MySQL CLI ho·∫∑c MySQLi (PHP)**  
```sql
START TRANSACTION;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;
COMMIT;
```
üìå **G·ª≠i t·∫•t c·∫£ l·ªánh c√πng l√∫c nhanh h∆°n g·ª≠i t·ª´ng l·ªánh ri√™ng l·∫ª.**  

---

## **5. PARTITION TABLE: Chia b·∫£ng l·ªõn th√†nh nhi·ªÅu ph·∫ßn nh·ªè**
#### üîπ **Gi·∫£m t·∫£i cho index v√† t·ªëi ∆∞u truy v·∫•n khi b·∫£ng qu√° l·ªõn.**  
- **D√πng khi b·∫£ng c√≥ h√†ng tri·ªáu ho·∫∑c h√†ng t·ª∑ b·∫£n ghi.**  
- **MySQL t·ª± ƒë·ªông ƒë·ªãnh tuy·∫øn truy v·∫•n ƒë·∫øn partition ph√π h·ª£p.**  

‚úÖ **V√≠ d·ª•: Chia b·∫£ng theo nƒÉm**  
```sql
CREATE TABLE orders (
    id INT NOT NULL,
    order_date DATE NOT NULL,
    amount DECIMAL(10,2) NOT NULL
) PARTITION BY RANGE (YEAR(order_date)) (
    PARTITION p2023 VALUES LESS THAN (2024),
    PARTITION p2024 VALUES LESS THAN (2025)
);
```
üìå **TƒÉng t·ªëc ƒë·ªô truy v·∫•n, v√¨ MySQL ch·ªâ t√¨m trong partition ph√π h·ª£p!**  

---

## **6. VIRTUAL COLUMN: C·ªôt ·∫£o gi√∫p t·ªëi ∆∞u truy v·∫•n**
#### üîπ **T·∫°o c·ªôt d·ª±a tr√™n bi·ªÉu th·ª©c, gi·∫£m chi ph√≠ l∆∞u tr·ªØ nh∆∞ng v·∫´n c√≥ index.**  
- **Kh√¥ng c·∫ßn l∆∞u tr·ªØ d·ªØ li·ªáu th·ª±c t·∫ø, MySQL t·ª± ƒë·ªông t√≠nh to√°n khi truy v·∫•n.**  

‚úÖ **V√≠ d·ª•: T·∫°o c·ªôt `total_price` d·ª±a tr√™n `quantity * price`**  
```sql
ALTER TABLE orders ADD total_price DECIMAL(10,2) AS (quantity * price) VIRTUAL;
```
üìå **Kh√¥ng chi·∫øm th√™m dung l∆∞·ª£ng l∆∞u tr·ªØ nh∆∞ng c√≥ th·ªÉ index!**  

---

## **7. TUNING TRANSACTIONS: Tinh ch·ªânh MySQL ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t**
#### üîπ **M·ªôt s·ªë tham s·ªë quan tr·ªçng c·∫ßn ƒëi·ªÅu ch·ªânh**
| Tham s·ªë | M·∫∑c ƒë·ªãnh | Gi√° tr·ªã t·ªëi ∆∞u |
|---------|----------|--------------|
| `innodb_buffer_pool_size` | 128MB | 50-75% RAM |
| `innodb_log_file_size` | 48MB | 512MB - 1GB |
| `innodb_flush_log_at_trx_commit` | 1 | 2 (TƒÉng hi·ªáu su·∫•t) |
| `sync_binlog` | 1 | 0 (TƒÉng t·ªëc ƒë·ªô ghi Binary Log) |

‚úÖ **C√°ch ki·ªÉm tra v√† thay ƒë·ªïi gi√° tr·ªã n√†y**  
```sql
SHOW VARIABLES LIKE 'innodb_buffer_pool_size';
SET GLOBAL innodb_buffer_pool_size = 4G;
```
üìå **ƒêi·ªÅu ch·ªânh gi√∫p gi·∫£m I/O Disk v√† tƒÉng hi·ªáu su·∫•t transaction.**  

---

## **K·∫æT LU·∫¨N**
| **Ch·ªß ƒë·ªÅ** | **L·ª£i √≠ch** |
|------------|------------|
| **SAVEPOINT** | Rollback m·ªôt ph·∫ßn transaction |
| **Deadlock Handling** | Tr√°nh conflict gi·ªØa transaction |
| **Group Commit** | TƒÉng t·ªëc ƒë·ªô COMMIT |
| **Multi-Statement Transactions** | Gi·∫£m latency t·ª´ ·ª©ng d·ª•ng |
| **Partition Table** | Gi·∫£m t·∫£i cho b·∫£ng l·ªõn |
| **Virtual Column** | TƒÉng t·ªëc ƒë·ªô truy v·∫•n |
| **Tuning MySQL** | T·ªëi ∆∞u b·ªô nh·ªõ v√† hi·ªáu su·∫•t |

üìå **N·∫øu b·∫°n l√†m vi·ªác v·ªõi h·ªá th·ªëng l·ªõn ho·∫∑c c·∫ßn t·ªëi ∆∞u transaction, c√°c k·ªπ thu·∫≠t n√†y s·∫Ω gi√∫p b·∫°n c·∫£i thi·ªán hi·ªáu su·∫•t ƒë√°ng k·ªÉ!**  



